import{b as hr,c as Pn,d as vn,e as Tn,f as Rn,g as _n,h as Nn,j as He,k as se}from"./chunk-2NSAFTGO.js";import{Ac as ao,Gc as wn,K as pr,L as lr,Qb as fr,R as yn,Sb as xn,T as An,V as nt,aa as Cn,k as En,l as Sn,p as ur,x as In}from"./chunk-QHHDSACN.js";import{a as u,b as S,d as gn}from"./chunk-JGDRNPQP.js";var Un="Logging",gr="x-amz-user-agent",bn="NoHubcallbackProvidedException";var le=(function(e){return e.DEBUG="DEBUG",e.ERROR="ERROR",e.INFO="INFO",e.WARN="WARN",e.VERBOSE="VERBOSE",e.NONE="NONE",e})(le||{});var On={VERBOSE:1,DEBUG:2,INFO:3,WARN:4,ERROR:5,NONE:6},M=(()=>{class e{constructor(o,r=le.WARN){this.name=o,this.level=r,this._pluggables=[]}_padding(o){return o<10?"0"+o:""+o}_ts(){let o=new Date;return[this._padding(o.getMinutes()),this._padding(o.getSeconds())].join(":")+"."+o.getMilliseconds()}configure(o){return o?(this._config=o,this._config):this._config}_log(o,...r){let n=this.level;e.LOG_LEVEL&&(n=e.LOG_LEVEL),typeof window<"u"&&window.LOG_LEVEL&&(n=window.LOG_LEVEL);let i=On[n];if(!(On[o]>=i))return;let a=console.log.bind(console);o===le.ERROR&&console.error&&(a=console.error.bind(console)),o===le.WARN&&console.warn&&(a=console.warn.bind(console)),e.BIND_ALL_LOG_LEVELS&&(o===le.INFO&&console.info&&(a=console.info.bind(console)),o===le.DEBUG&&console.debug&&(a=console.debug.bind(console)));let c=`[${o}] ${this._ts()} ${this.name}`,d="";if(r.length===1&&typeof r[0]=="string")d=`${c} - ${r[0]}`,a(d);else if(r.length===1)d=`${c} ${r[0]}`,a(c,r[0]);else if(typeof r[0]=="string"){let m=r.slice(1);m.length===1&&(m=m[0]),d=`${c} - ${r[0]} ${m}`,a(`${c} - ${r[0]}`,m)}else d=`${c} ${r}`,a(c,r);for(let m of this._pluggables){let p={message:d,timestamp:Date.now()};m.pushLogs([p])}}log(...o){this._log(le.INFO,...o)}info(...o){this._log(le.INFO,...o)}warn(...o){this._log(le.WARN,...o)}error(...o){this._log(le.ERROR,...o)}debug(...o){this._log(le.DEBUG,...o)}verbose(...o){this._log(le.VERBOSE,...o)}addPluggable(o){o&&o.getCategoryName()===Un&&(this._pluggables.push(o),o.configure(this._config))}listPluggables(){return this._pluggables}}return e.LOG_LEVEL=null,e.BIND_ALL_LOG_LEVELS=!1,e})();var H=class e extends Error{constructor({message:t,name:o,recoverySuggestion:r,underlyingError:n,metadata:i}){if(super(t),this.name=o,this.underlyingError=n,this.recoverySuggestion=r,i){let{extendedRequestId:s,httpStatusCode:a,requestId:c}=i;this.metadata={extendedRequestId:s,httpStatusCode:a,requestId:c}}this.constructor=e,Object.setPrototypeOf(this,e.prototype)}};var ae=(function(e){return e.NoEndpointId="NoEndpointId",e.PlatformNotSupported="PlatformNotSupported",e.Unknown="Unknown",e.NetworkError="NetworkError",e})(ae||{});var Pe=(e,t=H)=>(o,r,n)=>{let{message:i,recoverySuggestion:s}=e[r];if(!o)throw new t({name:r,message:n?`${i} ${n}`:i,recoverySuggestion:s})};var Y=typeof Symbol<"u"?Symbol("amplify_default"):"@@amplify_default",Ht=new M("Hub"),co=class{constructor(t){this.listeners=new Map,this.protectedChannels=["core","auth","api","analytics","interactions","pubsub","storage","ui","xr"],this.name=t}_remove(t,o){let r=this.listeners.get(t);if(!r){Ht.warn(`No listeners for ${t}`);return}this.listeners.set(t,[...r.filter(({callback:n})=>n!==o)])}dispatch(t,o,r,n){typeof t=="string"&&this.protectedChannels.indexOf(t)>-1&&(n===Y||Ht.warn(`WARNING: ${t} is protected and dispatching on it can have unintended consequences`));let i={channel:t,payload:u({},o),source:r,patternInfo:[]};try{this._toListeners(i)}catch(s){Ht.error(s)}}listen(t,o,r="noname"){let n;if(typeof o!="function")throw new H({name:bn,message:"No callback supplied to Hub"});n=o;let i=this.listeners.get(t);return i||(i=[],this.listeners.set(t,i)),i.push({name:r,callback:n}),()=>{this._remove(t,n)}}_toListeners(t){let{channel:o,payload:r}=t,n=this.listeners.get(o);n&&n.forEach(i=>{Ht.debug(`Dispatching to ${o} with `,r);try{i.callback(t)}catch(s){Ht.error(s)}})}},z=new co("__default__"),it=new co("internal-hub");var st=()=>{if(typeof window=="object"&&typeof window.crypto=="object")return window.crypto;if(typeof crypto=="object")return crypto;throw new H({name:"MissingPolyfill",message:"Cannot resolve the `crypto` function from the environment."})},Dn=()=>{if(typeof window<"u"&&typeof window.btoa=="function")return window.btoa;if(typeof btoa=="function")return btoa;throw new H({name:"Base64EncoderError",message:"Cannot resolve the `btoa` function from the environment."})},Mn=()=>{if(typeof window<"u"&&typeof window.atob=="function")return window.atob;if(typeof atob=="function")return atob;throw new H({name:"Base64EncoderError",message:"Cannot resolve the `atob` function from the environment."})};var at={convert(e,t){let o=e;return t?.urlSafe&&(o=o.replace(/-/g,"+").replace(/_/g,"/")),Mn()(o)}};var Ne=(function(e){return e.AuthTokenConfigException="AuthTokenConfigException",e.AuthUserPoolAndIdentityPoolException="AuthUserPoolAndIdentityPoolException",e.AuthUserPoolException="AuthUserPoolException",e.InvalidIdentityPoolIdException="InvalidIdentityPoolIdException",e.OAuthNotConfigureException="OAuthNotConfigureException",e})(Ne||{}),Ta={[Ne.AuthTokenConfigException]:{message:"Auth Token Provider not configured.",recoverySuggestion:"Make sure to call Amplify.configure in your app."},[Ne.AuthUserPoolAndIdentityPoolException]:{message:"Auth UserPool or IdentityPool not configured.",recoverySuggestion:"Make sure to call Amplify.configure in your app with UserPoolId and IdentityPoolId."},[Ne.AuthUserPoolException]:{message:"Auth UserPool not configured.",recoverySuggestion:"Make sure to call Amplify.configure in your app with userPoolId and userPoolClientId."},[Ne.InvalidIdentityPoolIdException]:{message:"Invalid identity pool id provided.",recoverySuggestion:"Make sure a valid identityPoolId is given in the config."},[Ne.OAuthNotConfigureException]:{message:"oauth param not configured.",recoverySuggestion:"Make sure to call Amplify.configure with oauth parameter in your app."}},mo=Pe(Ta);function I(e){let t=!0;e?t=!!e.userPoolId&&!!e.userPoolClientId:t=!1,mo(t,Ne.AuthUserPoolException)}function Be(e){let t=!!e?.loginWith?.oauth?.domain&&!!e?.loginWith?.oauth?.redirectSignOut&&!!e?.loginWith?.oauth?.redirectSignIn&&!!e?.loginWith?.oauth?.responseType;mo(t,Ne.OAuthNotConfigureException)}function ct(e){let t=!!e?.identityPoolId;mo(t,Ne.InvalidIdentityPoolIdException)}function Z(e){let t=e.split(".");if(t.length!==3)throw new Error("Invalid token");try{let r=t[1].replace(/-/g,"+").replace(/_/g,"/"),n=decodeURIComponent(at.convert(r).split("").map(s=>`%${`00${s.charCodeAt(0).toString(16)}`.slice(-2)}`).join("")),i=JSON.parse(n);return{toString:()=>e,payload:i}}catch{throw new Error("Invalid token payload")}}var Er=e=>{let t=Reflect.ownKeys(e);for(let o of t){let r=e[o];(r&&typeof r=="object"||typeof r=="function")&&Er(r)}return Object.freeze(e)};var Ra=new M("parseAWSExports"),_a={API_KEY:"apiKey",AWS_IAM:"iam",AMAZON_COGNITO_USER_POOLS:"userPool",OPENID_CONNECT:"oidc",NONE:"none",AWS_LAMBDA:"lambda",LAMBDA:"lambda"},Fn=(e={})=>{if(!Object.prototype.hasOwnProperty.call(e,"aws_project_region"))throw new H({name:"InvalidParameterException",message:"Invalid config parameter.",recoverySuggestion:"Ensure passing the config object imported from  `amplifyconfiguration.json`."});let{aws_appsync_apiKey:t,aws_appsync_authenticationType:o,aws_appsync_graphqlEndpoint:r,aws_appsync_region:n,aws_bots_config:i,aws_cognito_identity_pool_id:s,aws_cognito_sign_up_verification_method:a,aws_cognito_mfa_configuration:c,aws_cognito_mfa_types:d,aws_cognito_password_protection_settings:m,aws_cognito_verification_mechanisms:p,aws_cognito_signup_attributes:l,aws_cognito_social_providers:h,aws_cognito_username_attributes:E,aws_mandatory_sign_in:v,aws_mobile_analytics_app_id:T,aws_mobile_analytics_app_region:R,aws_user_files_s3_bucket:j,aws_user_files_s3_bucket_region:Ee,aws_user_files_s3_dangerously_connect_to_http_endpoint_for_testing:$e,aws_user_pools_id:pe,aws_user_pools_web_client_id:re,geo:ot,oauth:It,predictions:je,aws_cloud_logic_custom:Lt,Notifications:so,modelIntrospection:un}=e,X={};T&&(X.Analytics={Pinpoint:{appId:T,region:R}});let{InAppMessaging:dr,Push:mr}=so??{};if(dr?.AWSPinpoint||mr?.AWSPinpoint){if(dr?.AWSPinpoint){let{appId:K,region:rt}=dr.AWSPinpoint;X.Notifications={InAppMessaging:{Pinpoint:{appId:K,region:rt}}}}if(mr?.AWSPinpoint){let{appId:K,region:rt}=mr.AWSPinpoint;X.Notifications=S(u({},X.Notifications),{PushNotification:{Pinpoint:{appId:K,region:rt}}})}}if(Array.isArray(i)&&(X.Interactions={LexV1:Object.fromEntries(i.map(K=>[K.name,K]))}),r){let K=_a[o];K||Ra.debug(`Invalid authentication type ${o}. Falling back to IAM.`),X.API={GraphQL:{endpoint:r,apiKey:t,region:n,defaultAuthMode:K??"iam"}},un&&(X.API.GraphQL.modelIntrospection=un)}let ya=c?{status:c&&c.toLowerCase(),totpEnabled:d?.includes("TOTP")??!1,smsEnabled:d?.includes("SMS")??!1}:void 0,Aa=m?{minLength:m.passwordPolicyMinLength,requireLowercase:m.passwordPolicyCharacters?.includes("REQUIRES_LOWERCASE")??!1,requireUppercase:m.passwordPolicyCharacters?.includes("REQUIRES_UPPERCASE")??!1,requireNumbers:m.passwordPolicyCharacters?.includes("REQUIRES_NUMBERS")??!1,requireSpecialCharacters:m.passwordPolicyCharacters?.includes("REQUIRES_SYMBOLS")??!1}:void 0,Ca=Array.from(new Set([...p??[],...l??[]])).reduce((K,rt)=>S(u({},K),{[rt.toLowerCase()]:{required:!0}}),{}),pn=E?.includes("EMAIL")??!1,ln=E?.includes("PHONE_NUMBER")??!1;(s||pe)&&(X.Auth={Cognito:{identityPoolId:s,allowGuestAccess:v!=="enable",signUpVerificationMethod:a,userAttributes:Ca,userPoolClientId:re,userPoolId:pe,mfa:ya,passwordFormat:Aa,loginWith:{username:!(pn||ln),email:pn,phone:ln}}});let xa=It?Object.keys(It).length>0:!1,wa=h?h.length>0:!1;if(X.Auth&&xa&&(X.Auth.Cognito.loginWith=S(u({},X.Auth.Cognito.loginWith),{oauth:u(u({},Na(It)),wa&&{providers:Ua(h)})})),j&&(X.Storage={S3:{bucket:j,region:Ee,dangerouslyConnectToHttpEndpointForTesting:$e}}),ot){let{amazon_location_service:K}=ot;X.Geo={LocationService:{maps:K.maps,geofenceCollections:K.geofenceCollections,searchIndices:K.search_indices,region:K.region}}}if(Lt&&(X.API=S(u({},X.API),{REST:Lt.reduce((K,rt)=>{let{name:Pa,endpoint:va,region:fn,service:hn}=rt;return S(u({},K),{[Pa]:u(u({endpoint:va},hn?{service:hn}:void 0),fn?{region:fn}:void 0)})},{})})),je){let{VoiceId:K}=je?.convert?.speechGenerator?.defaults??{};X.Predictions=K?S(u({},je),{convert:S(u({},je.convert),{speechGenerator:S(u({},je.convert.speechGenerator),{defaults:{voiceId:K}})})}):je}return X},kn=e=>e?.split(",")??[],Na=({domain:e,scope:t,redirectSignIn:o,redirectSignOut:r,responseType:n})=>({domain:e,scopes:t,redirectSignIn:kn(o),redirectSignOut:kn(r),responseType:n}),Ua=e=>e.map(t=>{let o=t.toLowerCase();return o.charAt(0).toUpperCase()+o.slice(1)});var Bt=Symbol("oauth-listener");var Q=[];for(let e=0;e<256;++e)Q.push((e+256).toString(16).slice(1));function Ln(e,t=0){return(Q[e[t+0]]+Q[e[t+1]]+Q[e[t+2]]+Q[e[t+3]]+"-"+Q[e[t+4]]+Q[e[t+5]]+"-"+Q[e[t+6]]+Q[e[t+7]]+"-"+Q[e[t+8]]+Q[e[t+9]]+"-"+Q[e[t+10]]+Q[e[t+11]]+Q[e[t+12]]+Q[e[t+13]]+Q[e[t+14]]+Q[e[t+15]]).toLowerCase()}var Sr,ba=new Uint8Array(16);function Ir(){if(!Sr){if(typeof crypto>"u"||!crypto.getRandomValues)throw new Error("crypto.getRandomValues() not supported. See https://github.com/uuidjs/uuid#getrandomvalues-not-supported");Sr=crypto.getRandomValues.bind(crypto)}return Sr(ba)}var Oa=typeof crypto<"u"&&crypto.randomUUID&&crypto.randomUUID.bind(crypto),yr={randomUUID:Oa};function Da(e,t,o){if(yr.randomUUID&&!t&&!e)return yr.randomUUID();e=e||{};let r=e.random??e.rng?.()??Ir();if(r.length<16)throw new Error("Random bytes length must be >= 16");if(r[6]=r[6]&15|64,r[8]=r[8]&63|128,t){if(o=o||0,o<0||o+16>t.length)throw new RangeError(`UUID byte range ${o}:${o+15} is out of buffer bounds`);for(let n=0;n<16;++n)t[o+n]=r[n];return t}return Ln(r)}var Ar=Da;function Bn(e){let{version:t}=e;return t?t.startsWith("1"):!1}function Ma(e){if(!e)return;let{bucket_name:t,aws_region:o,buckets:r}=e;return{S3:{bucket:t,region:o,buckets:r&&qa(r)}}}function ka(e){if(!e)return;let{user_pool_id:t,user_pool_client_id:o,identity_pool_id:r,password_policy:n,mfa_configuration:i,mfa_methods:s,unauthenticated_identities_enabled:a,oauth:c,username_attributes:d,standard_required_attributes:m,groups:p}=e,l={Cognito:{userPoolId:t,userPoolClientId:o,groups:p}};return r&&(l.Cognito=S(u({},l.Cognito),{identityPoolId:r})),n&&(l.Cognito.passwordFormat={requireLowercase:n.require_lowercase,requireNumbers:n.require_numbers,requireUppercase:n.require_uppercase,requireSpecialCharacters:n.require_symbols,minLength:n.min_length??6}),i&&(l.Cognito.mfa={status:za(i),smsEnabled:s?.includes("SMS"),totpEnabled:s?.includes("TOTP")}),a&&(l.Cognito.allowGuestAccess=a),c&&(l.Cognito.loginWith={oauth:{domain:c.domain,redirectSignIn:c.redirect_sign_in_uri,redirectSignOut:c.redirect_sign_out_uri,responseType:c.response_type==="token"?"token":"code",scopes:c.scopes,providers:Ka(c.identity_providers)}}),d&&(l.Cognito.loginWith=S(u({},l.Cognito.loginWith),{email:d.includes("email"),phone:d.includes("phone_number"),username:d.includes("username")})),m&&(l.Cognito.userAttributes=m.reduce((h,E)=>S(u({},h),{[E]:{required:!0}}),{})),l}function Fa(e){if(!e?.amazon_pinpoint)return;let{amazon_pinpoint:t}=e;return{Pinpoint:{appId:t.app_id,region:t.aws_region}}}function La(e){if(!e)return;let{aws_region:t,geofence_collections:o,maps:r,search_indices:n}=e;return{LocationService:{region:t,searchIndices:n,geofenceCollections:o,maps:r}}}function Ha(e){if(!e)return;let{aws_region:t,default_authorization_type:o,url:r,api_key:n,model_introspection:i}=e;return{GraphQL:{endpoint:r,defaultAuthMode:Vn(o),region:t,apiKey:n,modelIntrospection:i}}}function Ba(e){if(!e?.events)return;let{url:t,aws_region:o,api_key:r,default_authorization_type:n}=e.events;return{Events:{endpoint:t,defaultAuthMode:Vn(n),region:o,apiKey:r}}}function Wa(e){if(!e)return;let{aws_region:t,channels:o,amazon_pinpoint_app_id:r}=e,n=o.includes("IN_APP_MESSAGING"),i=o.includes("APNS")||o.includes("FCM");if(!(n||i))return;let s={};return n&&(s.InAppMessaging={Pinpoint:{appId:r,region:t}}),i&&(s.PushNotification={Pinpoint:{appId:r,region:t}}),s}function Wn(e){let t={};if(e.storage&&(t.Storage=Ma(e.storage)),e.auth&&(t.Auth=ka(e.auth)),e.analytics&&(t.Analytics=Fa(e.analytics)),e.geo&&(t.Geo=La(e.geo)),e.data&&(t.API=Ha(e.data)),e.custom){let o=Ba(e.custom);o&&"Events"in o&&(t.API=u(u({},t.API),o))}return e.notifications&&(t.Notifications=Wa(e.notifications)),t}var Va={AMAZON_COGNITO_USER_POOLS:"userPool",API_KEY:"apiKey",AWS_IAM:"iam",AWS_LAMBDA:"lambda",OPENID_CONNECT:"oidc"};function Vn(e){return Va[e]}var Hn={GOOGLE:"Google",LOGIN_WITH_AMAZON:"Amazon",FACEBOOK:"Facebook",SIGN_IN_WITH_APPLE:"Apple"};function Ka(e=[]){return e.reduce((t,o)=>(Hn[o]!==void 0&&t.push(Hn[o]),t),[])}function za(e){return e==="OPTIONAL"?"optional":e==="REQUIRED"?"on":"off"}function qa(e){let t={};return e.forEach(({name:o,bucket_name:r,aws_region:n,paths:i})=>{if(o in t)throw new Error(`Duplicate friendly name found: ${o}. Name must be unique.`);let s=i?Object.entries(i).reduce((a,[c,d])=>(d!==void 0&&(a[c]=d),a),{}):void 0;t[o]={bucketName:r,region:n,paths:s}}),t}var Wt=e=>Object.keys(e).some(t=>t.startsWith("aws_"))?Fn(e):Bn(e)?Wn(e):e;var ce=64,Kn=32,zn=new Uint32Array([1116352408,1899447441,3049323471,3921009573,961987163,1508970993,2453635748,2870763221,3624381080,310598401,607225278,1426881987,1925078388,2162078206,2614888103,3248222580,3835390401,4022224774,264347078,604807628,770255983,1249150122,1555081692,1996064986,2554220882,2821834349,2952996808,3210313671,3336571891,3584528711,113926993,338241895,666307205,773529912,1294757372,1396182291,1695183700,1986661051,2177026350,2456956037,2730485921,2820302411,3259730800,3345764771,3516065817,3600352804,4094571909,275423344,430227734,506948616,659060556,883997877,958139571,1322822218,1537002063,1747873779,1955562222,2024104815,2227730452,2361852424,2428436474,2756734187,3204031479,3329325298]),qn=[1779033703,3144134277,1013904242,2773480762,1359893119,2600822924,528734635,1541459225],Gn=Math.pow(2,53)-1;var Vt=(function(){function e(){this.state=Int32Array.from(qn),this.temp=new Int32Array(64),this.buffer=new Uint8Array(64),this.bufferLength=0,this.bytesHashed=0,this.finished=!1}return e.prototype.update=function(t){if(this.finished)throw new Error("Attempted to update an already finished hash.");var o=0,r=t.byteLength;if(this.bytesHashed+=r,this.bytesHashed*8>Gn)throw new Error("Cannot hash more than 2^53 - 1 bits");for(;r>0;)this.buffer[this.bufferLength++]=t[o++],r--,this.bufferLength===ce&&(this.hashBuffer(),this.bufferLength=0)},e.prototype.digest=function(){if(!this.finished){var t=this.bytesHashed*8,o=new DataView(this.buffer.buffer,this.buffer.byteOffset,this.buffer.byteLength),r=this.bufferLength;if(o.setUint8(this.bufferLength++,128),r%ce>=ce-8){for(var n=this.bufferLength;n<ce;n++)o.setUint8(n,0);this.hashBuffer(),this.bufferLength=0}for(var n=this.bufferLength;n<ce-8;n++)o.setUint8(n,0);o.setUint32(ce-8,Math.floor(t/4294967296),!0),o.setUint32(ce-4,t),this.hashBuffer(),this.finished=!0}for(var i=new Uint8Array(Kn),n=0;n<8;n++)i[n*4]=this.state[n]>>>24&255,i[n*4+1]=this.state[n]>>>16&255,i[n*4+2]=this.state[n]>>>8&255,i[n*4+3]=this.state[n]>>>0&255;return i},e.prototype.hashBuffer=function(){for(var t=this,o=t.buffer,r=t.state,n=r[0],i=r[1],s=r[2],a=r[3],c=r[4],d=r[5],m=r[6],p=r[7],l=0;l<ce;l++){if(l<16)this.temp[l]=(o[l*4]&255)<<24|(o[l*4+1]&255)<<16|(o[l*4+2]&255)<<8|o[l*4+3]&255;else{var h=this.temp[l-2],E=(h>>>17|h<<15)^(h>>>19|h<<13)^h>>>10;h=this.temp[l-15];var v=(h>>>7|h<<25)^(h>>>18|h<<14)^h>>>3;this.temp[l]=(E+this.temp[l-7]|0)+(v+this.temp[l-16]|0)}var T=(((c>>>6|c<<26)^(c>>>11|c<<21)^(c>>>25|c<<7))+(c&d^~c&m)|0)+(p+(zn[l]+this.temp[l]|0)|0)|0,R=((n>>>2|n<<30)^(n>>>13|n<<19)^(n>>>22|n<<10))+(n&i^n&s^i&s)|0;p=m,m=d,d=c,c=a+T|0,a=s,s=i,i=n,n=T+R|0}r[0]+=n,r[1]+=i,r[2]+=s,r[3]+=a,r[4]+=c,r[5]+=d,r[6]+=m,r[7]+=p},e})();var Cr=e=>new TextEncoder().encode(e);var Ga=typeof Buffer<"u"&&Buffer.from?function(e){return Buffer.from(e,"utf8")}:Cr;function uo(e){return e instanceof Uint8Array?e:typeof e=="string"?Ga(e):ArrayBuffer.isView(e)?new Uint8Array(e.buffer,e.byteOffset,e.byteLength/Uint8Array.BYTES_PER_ELEMENT):new Uint8Array(e)}function xr(e){return typeof e=="string"?e.length===0:e.byteLength===0}var We=(function(){function e(t){this.secret=t,this.hash=new Vt,this.reset()}return e.prototype.update=function(t){if(!(xr(t)||this.error))try{this.hash.update(uo(t))}catch(o){this.error=o}},e.prototype.digestSync=function(){if(this.error)throw this.error;return this.outer?(this.outer.finished||this.outer.update(this.hash.digest()),this.outer.digest()):this.hash.digest()},e.prototype.digest=function(){return En(this,void 0,void 0,function(){return Sn(this,function(t){return[2,this.digestSync()]})})},e.prototype.reset=function(){if(this.hash=new Vt,this.secret){this.outer=new Vt;var t=$a(this.secret),o=new Uint8Array(ce);o.set(t);for(var r=0;r<ce;r++)t[r]^=54,o[r]^=92;this.hash.update(t),this.outer.update(o);for(var r=0;r<t.byteLength;r++)t[r]=0}},e})();function $a(e){var t=uo(e);if(t.byteLength>ce){var o=new Vt;o.update(t),t=o.digest()}var r=new Uint8Array(ce);return r.set(t),r}var ja={},Ya={};for(let e=0;e<256;e++){let t=e.toString(16).toLowerCase();t.length===1&&(t=`0${t}`),ja[e]=t,Ya[t]=e}var F=(function(e){return e.WebUnknown="0",e.React="1",e.NextJs="2",e.Angular="3",e.VueJs="4",e.Nuxt="5",e.Svelte="6",e.ServerSideUnknown="100",e.ReactSSR="101",e.NextJsSSR="102",e.AngularSSR="103",e.VueJsSSR="104",e.NuxtSSR="105",e.SvelteSSR="106",e.ReactNative="201",e.Expo="202",e})(F||{}),po=(function(e){return e.AI="ai",e.API="api",e.Auth="auth",e.Analytics="analytics",e.DataStore="datastore",e.Geo="geo",e.InAppMessaging="inappmessaging",e.Interactions="interactions",e.Predictions="predictions",e.PubSub="pubsub",e.PushNotification="pushnotification",e.Storage="storage",e})(po||{});var w=(function(e){return e.SignUp="1",e.ConfirmSignUp="2",e.ResendSignUpCode="3",e.SignIn="4",e.FetchMFAPreference="6",e.UpdateMFAPreference="7",e.SetUpTOTP="10",e.VerifyTOTPSetup="11",e.ConfirmSignIn="12",e.DeleteUserAttributes="15",e.DeleteUser="16",e.UpdateUserAttributes="17",e.FetchUserAttributes="18",e.ConfirmUserAttribute="22",e.SignOut="26",e.UpdatePassword="27",e.ResetPassword="28",e.ConfirmResetPassword="29",e.FederatedSignIn="30",e.RememberDevice="32",e.ForgetDevice="33",e.FetchDevices="34",e.SendUserAttributeVerificationCode="35",e.SignInWithRedirect="36",e.StartWebAuthnRegistration="37",e.CompleteWebAuthnRegistration="38",e.ListWebAuthnCredentials="39",e.DeleteWebAuthnCredential="40",e})(w||{});var wr="6.15.5";var Ye=()=>typeof global<"u";var Se=()=>typeof window<"u",lo=()=>typeof document<"u",yt=()=>typeof process<"u",Je=(e,t)=>!!Object.keys(e).find(o=>o.startsWith(t));function $n(){let e=r=>r.startsWith("_react")||r.startsWith("__react"),t=r=>Object.keys(r).find(e),o=()=>Array.from(document.querySelectorAll("[id]"));return lo()&&o().some(t)}function jn(){return yt()&&typeof process.env<"u"&&!!Object.keys(process.env).find(e=>e.includes("react"))}function Yn(){return Se()&&Je(window,"__VUE")}function Jn(){return Ye()&&Je(global,"__VUE")}function Xn(){return Se()&&Je(window,"__SVELTE")}function Zn(){return yt()&&typeof process.env<"u"&&!!Object.keys(process.env).find(e=>e.includes("svelte"))}function Qn(){return Se()&&window.next&&typeof window.next=="object"}function ei(){return Ye()&&(Je(global,"__next")||Je(global,"__NEXT"))}function ti(){return Se()&&(window.__NUXT__!==void 0||window.$nuxt!==void 0)}function oi(){return Ye()&&typeof global.__NUXT_PATHS__<"u"}function ri(){let e=!!(lo()&&document.querySelector("[ng-version]")),t=!!(Se()&&typeof window.ng<"u");return e||t}function ni(){return yt()&&typeof process.env=="object"&&process.env.npm_lifecycle_script?.startsWith("ng ")||!1}function ii(){return typeof navigator<"u"&&typeof navigator.product<"u"&&navigator.product==="ReactNative"}function si(){return Ye()&&typeof global.expo<"u"}function ai(){return Se()}var Ja=[{platform:F.Expo,detectionMethod:si},{platform:F.ReactNative,detectionMethod:ii},{platform:F.NextJs,detectionMethod:Qn},{platform:F.Nuxt,detectionMethod:ti},{platform:F.Angular,detectionMethod:ri},{platform:F.React,detectionMethod:$n},{platform:F.VueJs,detectionMethod:Yn},{platform:F.Svelte,detectionMethod:Xn},{platform:F.WebUnknown,detectionMethod:ai},{platform:F.NextJsSSR,detectionMethod:ei},{platform:F.NuxtSSR,detectionMethod:oi},{platform:F.ReactSSR,detectionMethod:jn},{platform:F.VueJsSSR,detectionMethod:Jn},{platform:F.AngularSSR,detectionMethod:ni},{platform:F.SvelteSSR,detectionMethod:Zn}];function ci(){return Ja.find(e=>e.detectionMethod())?.platform||F.ServerSideUnknown}var Kt,fo=[],ho=!1,Xa=10,Za=10,Qa=1e3,go=()=>{if(!Kt){if(Kt=ci(),ho)for(;fo.length;)fo.pop()?.();else fo.forEach(e=>{e()});di(F.ServerSideUnknown,Xa),di(F.WebUnknown,Za)}return Kt},mi=e=>{ho||fo.push(e)};function ec(){Kt=void 0}function di(e,t){Kt===e&&!ho&&setTimeout(()=>{ec(),ho=!0,setTimeout(go,Qa)},t)}var tc={};var ui=(e,t)=>tc[e]?.[t]?.additionalDetails;var pi="aws-amplify",li=e=>e.replace(/\+.*/,""),Pr=class{constructor(){this.userAgent=`${pi}/${li(wr)}`}get framework(){return go()}get isReactNative(){return this.framework===F.ReactNative||this.framework===F.Expo}observeFrameworkChanges(t){mi(t)}},oc=new Pr,fi=({category:e,action:t}={})=>{let o=[[pi,li(wr)]];if(e&&o.push([e,t]),o.push(["framework",go()]),e&&t){let r=ui(e,t);r&&r.forEach(n=>{o.push(n)})}return o},Ve=e=>fi(e).map(([r,n])=>r&&n?`${r}/${n}`:r).join(" ");var Ke=()=>typeof window<"u"&&typeof window.document<"u";var hi=new M("Auth"),Eo=class{configure(t,o){this.authConfig=t,this.authOptions=o,t&&t.Cognito?.userPoolEndpoint&&hi.warn(gi("Amazon Cognito User Pool")),t&&t.Cognito?.identityPoolEndpoint&&hi.warn(gi("Amazon Cognito Identity Pool"))}async fetchAuthSession(t={}){let o,r,n=await this.getTokens(t);return n?(r=n.accessToken?.payload?.sub,o=await this.authOptions?.credentialsProvider?.getCredentialsAndIdentityId({authConfig:this.authConfig,tokens:n,authenticated:!0,forceRefresh:t.forceRefresh})):o=await this.authOptions?.credentialsProvider?.getCredentialsAndIdentityId({authConfig:this.authConfig,authenticated:!1,forceRefresh:t.forceRefresh}),{tokens:n,credentials:o?.credentials,identityId:o?.identityId,userSub:r}}async clearCredentials(){await this.authOptions?.credentialsProvider?.clearCredentialsAndIdentityId()}async getTokens(t){return await this.authOptions?.tokenProvider?.getTokens(t)??void 0}},gi=e=>`You are using a custom Amazon ${e} endpoint, ensure the endpoint is correct.`;var So=class{constructor(){this.oAuthListener=void 0,this.isConfigured=!1,this.resourcesConfig={},this.libraryOptions={},this.Auth=new Eo}configure(t,o){let r=Wt(t);this.resourcesConfig=r,o&&(this.libraryOptions=o),this.resourcesConfig=Er(this.resourcesConfig),this.Auth.configure(this.resourcesConfig.Auth,this.libraryOptions.Auth),z.dispatch("core",{event:"configure",data:this.resourcesConfig},"Configure",Y),this.notifyOAuthListener(),this.isConfigured=!0}getConfig(){return this.isConfigured||console.warn("Amplify has not been configured. Please call Amplify.configure() before using this service."),this.resourcesConfig}[Bt](t){this.resourcesConfig.Auth?.Cognito.loginWith?.oauth?t(this.resourcesConfig.Auth?.Cognito):this.oAuthListener=t}notifyOAuthListener(){!this.resourcesConfig.Auth?.Cognito.loginWith?.oauth||!this.oAuthListener||(this.oAuthListener(this.resourcesConfig.Auth?.Cognito),this.oAuthListener=void 0)}},A=new So;var zt=(e,t)=>e.Auth.fetchAuthSession(t);var qt=e=>zt(A,e);function Gt(){return A.Auth.clearCredentials()}var dt=e=>{let{headers:t,statusCode:o}=e;return S(u({},rc(e)?e.$metadata:{}),{httpStatusCode:o,requestId:t["x-amzn-requestid"]??t["x-amzn-request-id"]??t["x-amz-request-id"],extendedRequestId:t["x-amz-id-2"],cfId:t["x-amz-cf-id"]})},rc=e=>typeof e?.$metadata=="object";var fe=async e=>{if(!e||e.statusCode<300)return;let t=await Ue(e),r=(s=>{let[a]=s.toString().split(/[,:]+/);return a.includes("#")?a.split("#")[1]:a})(e.headers["x-amzn-errortype"]??t.code??t.__type??"UnknownError"),n=t.message??t.Message??"Unknown error",i=new Error(n);return Object.assign(i,{name:r,$metadata:dt(e)})},Ue=async e=>{if(!e.body)throw new Error("Missing response payload");let t=await e.body.json();return Object.assign(t,{$metadata:dt(e)})};var N=(e,t,o,r)=>async(n,i)=>{let s=u(u({},r),n),a=await s.endpointResolver(s,i),c=await t(i,a),d=await e(c,u({},s));return o(d)};function Ei(e=3e5){return r=>{let n=2**r*100+100*Math.random();return n>e?!1:n}}var vr="amz-sdk-invocation-id",Si="amz-sdk-request";var $t=e=>{let o=Ei(3e5)(e);return o===!1?3e5:o};var ic=["AuthFailure","InvalidSignatureException","RequestExpired","RequestInTheFuture","RequestTimeTooSkewed","SignatureDoesNotMatch","BadRequestException"],Ii=e=>!!e&&ic.includes(e);var jt=e=>async(t,o)=>{let r=o??await e(t)??void 0,n=r?.code||r?.name,i=t?.statusCode;return{retryable:dc(o)||cc(i,n)||Ii(n)||mc(i,n)}},sc=["BandwidthLimitExceeded","EC2ThrottledException","LimitExceededException","PriorRequestNotComplete","ProvisionedThroughputExceededException","RequestLimitExceeded","RequestThrottled","RequestThrottledException","SlowDown","ThrottledException","Throttling","ThrottlingException","TooManyRequestsException"],ac=["TimeoutError","RequestTimeout","RequestTimeoutException"],cc=(e,t)=>e===429||!!t&&sc.includes(t),dc=e=>[ae.NetworkError,"ERR_NETWORK"].includes(e?.name),mc=(e,t)=>!!e&&[500,502,503,504].includes(e)||!!t&&ac.includes(t);var Tr="cognito-identity",Io={service:Tr,retryDecider:jt(fe),computeDelay:$t,cache:"no-store"};var Ci=({maxAttempts:e=3,retryDecider:t,computeDelay:o,abortSignal:r})=>{if(e<1)throw new Error("maxAttempts must be greater than 0");return(n,i)=>async function(a){let c,d=i.attemptsCount??0,m,p=()=>{if(m)return yi(m,d),m;throw yi(c,d),c};for(;!r?.aborted&&d<e;){try{m=await n(a),c=void 0}catch(E){c=E,m=void 0}d=(i.attemptsCount??0)>d?i.attemptsCount??0:d+1,i.attemptsCount=d;let{isCredentialsExpiredError:l,retryable:h}=await t(m,c,i);if(h){if(i.isCredentialsExpired=!!l,!r?.aborted&&d<e){let E=o(d);await uc(E,r)}continue}else return p()}if(r?.aborted)throw new Error("Request aborted.");return p()}},uc=(e,t)=>{if(t?.aborted)return Promise.resolve();let o,r,n=new Promise(i=>{r=i,o=setTimeout(i,e)});return t?.addEventListener("abort",function i(s){clearTimeout(o),t?.removeEventListener("abort",i),r()}),n},yi=(e,t)=>{Object.prototype.toString.call(e)==="[object Object]"&&(e.$metadata=S(u({},e.$metadata??{}),{attempts:t}))};var xi=Ar;var wi=()=>e=>async function(o){return o.headers[vr]||(o.headers[vr]=xi()),e(o)};var Pi=({maxAttempts:e=3})=>(t,o)=>async function(n){let i=o.attemptsCount??0;return n.headers[Si]=`attempt=${i+1}; max=${e}`,t(n)};var vi=({userAgentHeader:e="x-amz-user-agent",userAgentValue:t=""})=>o=>async function(n){if(t.trim().length===0)return await o(n);{let i=e.toLowerCase();return n.headers[i]=n.headers[i]?`${n.headers[i]} ${t}`:t,await o(n)}};var mt=(e,t)=>(o,r)=>{let n={},i=s=>e(s,r);for(let s=t.length-1;s>=0;s--){let a=t[s];i=a(r)(i,n)}return i(o)};var yo=e=>{let t;return()=>(t||(t=e()),t)};var pc=e=>!["HEAD","GET"].includes(e.toUpperCase()),Ti=async({url:e,method:t,headers:o,body:r},{abortSignal:n,cache:i,withCrossDomainCredentials:s})=>{let a;try{a=await fetch(e,{method:t,headers:o,body:pc(t)?r:void 0,signal:n,cache:i,credentials:s?"include":"same-origin"})}catch(p){throw p instanceof TypeError?new H({name:ae.NetworkError,message:"A network error has occurred.",underlyingError:p}):p}let c={};a.headers?.forEach((p,l)=>{c[l.toLowerCase()]=p});let d={statusCode:a.status,headers:c,body:null},m=Object.assign(a.body??{},{text:yo(()=>a.text()),blob:yo(()=>a.blob()),json:yo(()=>a.json())});return S(u({},d),{body:m})};var Yt=mt(Ti,[vi,wi,Ci,Pi]);var Ri=()=>e=>async function(o){return o.headers["cache-control"]="no-store",e(o)};var Ao=mt(Yt,[Ri]);var Co=e=>(t,o)=>{let r=lc(e),n=JSON.stringify(t);return fc(o,r,n)},lc=e=>({"content-type":"application/x-amz-json-1.1","x-amz-target":`AWSCognitoIdentityService.${e}`}),fc=({url:e},t,o)=>({headers:t,url:e,body:o,method:"POST"});var xo=e=>N(Ao,Co("GetCredentialsForIdentity"),hc,S(u(u({},Io),e),{userAgentValue:Ve()})),hc=async e=>{if(e.statusCode>=300)throw await fe(e);let t=await Ue(e);return{IdentityId:t.IdentityId,Credentials:gc(t.Credentials),$metadata:dt(e)}},gc=(o={})=>{var r=o,{Expiration:e}=r,t=gn(r,["Expiration"]);return S(u({},t),{Expiration:e&&new Date(e*1e3)})};var Rr=e=>N(Ao,Co("GetId"),Ec,S(u(u({},Io),e),{userAgentValue:Ve()})),Ec=async e=>{if(e.statusCode>=300)throw await fe(e);return{IdentityId:(await Ue(e)).IdentityId,$metadata:dt(e)}};var _r={id:"aws",outputs:{dnsSuffix:"amazonaws.com"},regionRegex:"^(us|eu|ap|sa|ca|me|af)\\-\\w+\\-\\d+$",regions:["aws-global"]},_i={partitions:[_r,{id:"aws-cn",outputs:{dnsSuffix:"amazonaws.com.cn"},regionRegex:"^cn\\-\\w+\\-\\d+$",regions:["aws-cn-global"]}]};var Jt=e=>{let{partitions:t}=_i;for(let{regions:o,outputs:r,regionRegex:n}of t){let i=new RegExp(n);if(o.includes(e)||i.test(e))return r.dnsSuffix}return _r.outputs.dnsSuffix};var ne=URL;var Nr=({region:e})=>({url:new ne(`https://${Tr}.${e}.${Jt(e)}`)});var ze=class extends H{constructor(){super({name:ae.PlatformNotSupported,message:"Function not supported on current platform"})}};var be=class{constructor(t){this.storage=t}async setItem(t,o){if(!this.storage)throw new ze;this.storage.setItem(t,o)}async getItem(t){if(!this.storage)throw new ze;return this.storage.getItem(t)}async removeItem(t){if(!this.storage)throw new ze;this.storage.removeItem(t)}async clear(){if(!this.storage)throw new ze;this.storage.clear()}};var ut=class{constructor(){this.storage=new Map}get length(){return this.storage.size}key(t){return t>this.length-1?null:Array.from(this.storage.keys())[t]}setItem(t,o){this.storage.set(t,o)}getItem(t){return this.storage.get(t)??null}removeItem(t){this.storage.delete(t)}clear(){this.storage.clear()}};var Ni=new M("CoreStorageUtils"),wo=()=>{try{if(typeof window<"u"&&window.localStorage)return window.localStorage}catch{Ni.info("localStorage not found. InMemoryStorage is used as a fallback.")}return new ut},Po=()=>{try{if(typeof window<"u"&&window.sessionStorage)return window.sessionStorage.getItem("test"),window.sessionStorage;throw new Error("sessionStorage is not defined")}catch{return Ni.info("sessionStorage not found. InMemoryStorage is used as a fallback."),new ut}};var vo=class extends be{constructor(){super(wo())}};var To=class extends be{constructor(){super(Po())}};var Ro=class{constructor(t){this._storage=t}get storage(){if(!this._storage)throw new ze;return this._storage}setItem(t,o){this.storage.setItem(t,o)}getItem(t){return this.storage.getItem(t)}removeItem(t){this.storage.removeItem(t)}clear(){this.storage.clear()}};var _o=class extends Ro{constructor(){super(Po())}};function No(e){for(var t=1;t<arguments.length;t++){var o=arguments[t];for(var r in o)e[r]=o[r]}return e}var Sc={read:function(e){return e[0]==='"'&&(e=e.slice(1,-1)),e.replace(/(%[\dA-F]{2})+/gi,decodeURIComponent)},write:function(e){return encodeURIComponent(e).replace(/%(2[346BF]|3[AC-F]|40|5[BDE]|60|7[BCD])/g,decodeURIComponent)}};function Ur(e,t){function o(n,i,s){if(!(typeof document>"u")){s=No({},t,s),typeof s.expires=="number"&&(s.expires=new Date(Date.now()+s.expires*864e5)),s.expires&&(s.expires=s.expires.toUTCString()),n=encodeURIComponent(n).replace(/%(2[346B]|5E|60|7C)/g,decodeURIComponent).replace(/[()]/g,escape);var a="";for(var c in s)s[c]&&(a+="; "+c,s[c]!==!0&&(a+="="+s[c].split(";")[0]));return document.cookie=n+"="+e.write(i,n)+a}}function r(n){if(!(typeof document>"u"||arguments.length&&!n)){for(var i=document.cookie?document.cookie.split("; "):[],s={},a=0;a<i.length;a++){var c=i[a].split("="),d=c.slice(1).join("=");try{var m=decodeURIComponent(c[0]);if(s[m]=e.read(d,m),n===m)break}catch{}}return n?s[n]:s}}return Object.create({set:o,get:r,remove:function(n,i){o(n,"",No({},i,{expires:-1}))},withAttributes:function(n){return Ur(this.converter,No({},this.attributes,n))},withConverter:function(n){return Ur(No({},this.converter,n),this.attributes)}},{attributes:{value:Object.freeze(t)},converter:{value:Object.freeze(e)}})}var Xt=Ur(Sc,{path:"/"});var At=class{constructor(t={}){let{path:o,domain:r,expires:n,sameSite:i,secure:s}=t;if(this.domain=r,this.path=o||"/",this.expires=Object.prototype.hasOwnProperty.call(t,"expires")?n:365,this.secure=Object.prototype.hasOwnProperty.call(t,"secure")?s:!0,Object.prototype.hasOwnProperty.call(t,"sameSite")){if(!i||!["strict","lax","none"].includes(i))throw new Error('The sameSite value of cookieStorage must be "lax", "strict" or "none".');if(i==="none"&&!this.secure)throw new Error("sameSite = None requires the Secure attribute in latest browser versions.");this.sameSite=i}}async setItem(t,o){Xt.set(t,o,this.getData())}async getItem(t){return Xt.get(t)??null}async removeItem(t){Xt.remove(t,this.getData())}async clear(){let t=Xt.get(),o=Object.keys(t).map(r=>this.removeItem(r));await Promise.all(o)}getData(){return u({path:this.path,expires:this.expires,domain:this.domain,secure:this.secure},this.sameSite&&{sameSite:this.sameSite})}};var Ie=new vo,Ui=new To,ve=new _o,bi=new be(new ut);var Xe={keyPrefix:"aws-amplify-cache",capacityInBytes:1048576,itemMaxSize:21e4,defaultTTL:2592e5,defaultPriority:5,warningThreshold:.8},qe="CurSize";function br(e){let t=0;t=e.length;for(let o=e.length;o>=0;o-=1){let r=e.charCodeAt(o);r>127&&r<=2047?t+=1:r>2047&&r<=65535&&(t+=2),r>=56320&&r<=57343&&(o-=1)}return t}function Ze(){return new Date().getTime()}var pt=e=>`${e}${qe}`;var lt=(function(e){return e.NoCacheItem="NoCacheItem",e.NullNextNode="NullNextNode",e.NullPreviousNode="NullPreviousNode",e})(lt||{}),Ic={[lt.NoCacheItem]:{message:"Item not found in the cache storage."},[lt.NullNextNode]:{message:"Next node is null."},[lt.NullPreviousNode]:{message:"Previous node is null."}},Or=Pe(Ic);var V=new M("StorageCache"),Uo=class{constructor({config:t,keyValueStorage:o}){this.config=u(u({},Xe),t),this.keyValueStorage=o,this.sanitizeConfig()}getModuleName(){return"Cache"}configure(t){return t&&(t.keyPrefix&&V.warn("keyPrefix can not be re-configured on an existing Cache instance."),this.config=u(u({},this.config),t)),this.sanitizeConfig(),this.config}async getCurrentCacheSize(){let t=await this.getStorage().getItem(pt(this.config.keyPrefix));return t||(await this.getStorage().setItem(pt(this.config.keyPrefix),"0"),t="0"),Number(t)}async setItem(t,o,r){if(V.debug(`Set item: key is ${t}, value is ${o} with options: ${r}`),!t||t===qe){V.warn(`Invalid key: should not be empty or reserved key: '${qe}'`);return}if(typeof o>"u"){V.warn("The value of item should not be undefined!");return}let n={priority:r?.priority!==void 0?r.priority:this.config.defaultPriority,expires:r?.expires!==void 0?r.expires:this.config.defaultTTL+Ze()};if(n.priority<1||n.priority>5){V.warn("Invalid parameter: priority due to out or range. It should be within 1 and 5.");return}let i=`${this.config.keyPrefix}${t}`,s=this.fillCacheItem(i,o,n);if(s.byteSize>this.config.itemMaxSize){V.warn(`Item with key: ${t} you are trying to put into is too big!`);return}try{let a=await this.getStorage().getItem(i);if(a&&await this.removeCacheItem(i,JSON.parse(a).byteSize),await this.isCacheFull(s.byteSize)){let c=await this.clearInvalidAndGetRemainingKeys();if(await this.isCacheFull(s.byteSize)){let d=await this.sizeToPop(s.byteSize);await this.popOutItems(c,d)}}return this.setCacheItem(i,s)}catch(a){V.warn(`setItem failed! ${a}`)}}async getItem(t,o){V.debug(`Get item: key is ${t} with options ${o}`);let r;if(!t||t===qe)return V.warn(`Invalid key: should not be empty or reserved key: '${qe}'`),null;let n=`${this.config.keyPrefix}${t}`;try{if(r=await this.getStorage().getItem(n),r!=null)if(await this.isExpired(n))await this.removeCacheItem(n,JSON.parse(r).byteSize);else return(await this.updateVisitedTime(JSON.parse(r),n)).data;if(o?.callback){let i=o.callback();return i!==null&&await this.setItem(t,i,o),i}return null}catch(i){return V.warn(`getItem failed! ${i}`),null}}async removeItem(t){if(V.debug(`Remove item: key is ${t}`),!t||t===qe){V.warn(`Invalid key: should not be empty or reserved key: '${qe}'`);return}let o=`${this.config.keyPrefix}${t}`;try{let r=await this.getStorage().getItem(o);r&&await this.removeCacheItem(o,JSON.parse(r).byteSize)}catch(r){V.warn(`removeItem failed! ${r}`)}}async getAllKeys(){try{return await this.getAllCacheKeys()}catch(t){return V.warn(`getAllkeys failed! ${t}`),[]}}getStorage(){return this.keyValueStorage}async isExpired(t){let o=await this.getStorage().getItem(t);Or(o!==null,lt.NoCacheItem,`Key: ${t}`);let r=JSON.parse(o);return Ze()>=r.expires}async removeCacheItem(t,o){let r=await this.getStorage().getItem(t);Or(r!==null,lt.NoCacheItem,`Key: ${t}`);let n=o??JSON.parse(r).byteSize;await this.decreaseCurrentSizeInBytes(n);try{await this.getStorage().removeItem(t)}catch(i){await this.increaseCurrentSizeInBytes(n),V.error(`Failed to remove item: ${i}`)}}fillCacheItem(t,o,r){let n={key:t,data:o,timestamp:Ze(),visitedTime:Ze(),priority:r.priority??0,expires:r.expires??0,type:typeof o,byteSize:0};return n.byteSize=br(JSON.stringify(n)),n.byteSize=br(JSON.stringify(n)),n}sanitizeConfig(){this.config.itemMaxSize>this.config.capacityInBytes&&(V.error("Invalid parameter: itemMaxSize. It should be smaller than capacityInBytes. Setting back to default."),this.config.itemMaxSize=Xe.itemMaxSize),(this.config.defaultPriority>5||this.config.defaultPriority<1)&&(V.error("Invalid parameter: defaultPriority. It should be between 1 and 5. Setting back to default."),this.config.defaultPriority=Xe.defaultPriority),(Number(this.config.warningThreshold)>1||Number(this.config.warningThreshold)<0)&&(V.error("Invalid parameter: warningThreshold. It should be between 0 and 1. Setting back to default."),this.config.warningThreshold=Xe.warningThreshold);let t=5*1024*1024;this.config.capacityInBytes>t&&(V.error("Cache Capacity should be less than 5MB. Setting back to default. Setting back to default."),this.config.capacityInBytes=Xe.capacityInBytes)}async increaseCurrentSizeInBytes(t){let o=await this.getCurrentCacheSize();await this.getStorage().setItem(pt(this.config.keyPrefix),(o+t).toString())}async decreaseCurrentSizeInBytes(t){let o=await this.getCurrentCacheSize();await this.getStorage().setItem(pt(this.config.keyPrefix),(o-t).toString())}async updateVisitedTime(t,o){return t.visitedTime=Ze(),await this.getStorage().setItem(o,JSON.stringify(t)),t}async setCacheItem(t,o){await this.increaseCurrentSizeInBytes(o.byteSize);try{await this.getStorage().setItem(t,JSON.stringify(o))}catch(r){await this.decreaseCurrentSizeInBytes(o.byteSize),V.error(`Failed to set item ${r}`)}}async sizeToPop(t){let r=await this.getCurrentCacheSize()+t-this.config.capacityInBytes,n=(1-this.config.warningThreshold)*this.config.capacityInBytes;return r>n?r:n}async isCacheFull(t){let o=await this.getCurrentCacheSize();return t+o>this.config.capacityInBytes}async popOutItems(t,o){let r=[],n=o;for(let i of t){let s=await this.getStorage().getItem(i);if(s!=null){let a=JSON.parse(s);r.push(a)}}r.sort((i,s)=>i.priority>s.priority?-1:i.priority<s.priority?1:i.visitedTime<s.visitedTime?-1:1);for(let i of r)if(await this.removeCacheItem(i.key,i.byteSize),n-=i.byteSize,n<=0)return}async clearInvalidAndGetRemainingKeys(){let t=[],o=await this.getAllCacheKeys({omitSizeKey:!0});for(let r of o)await this.isExpired(r)?await this.removeCacheItem(r):t.push(r);return t}async clear(){V.debug("Clear Cache");try{let t=await this.getAllKeys();for(let o of t){let r=`${this.config.keyPrefix}${o}`;await this.getStorage().removeItem(r)}}catch(t){V.warn(`clear failed! ${t}`)}}};var yc=new M("StorageCache"),bo=class e extends Uo{constructor(t){let o=wo();super({config:t,keyValueStorage:new be(o)}),this.storage=o,this.getItem=this.getItem.bind(this),this.setItem=this.setItem.bind(this),this.removeItem=this.removeItem.bind(this)}async getAllCacheKeys(t){let{omitSizeKey:o}=t??{},r=[];for(let n=0;n<this.storage.length;n++){let i=this.storage.key(n);o&&i===pt(this.config.keyPrefix)||i?.startsWith(this.config.keyPrefix)&&r.push(i.substring(this.config.keyPrefix.length))}return r}createInstance(t){return(!t.keyPrefix||t.keyPrefix===Xe.keyPrefix)&&(yc.error("invalid keyPrefix, setting keyPrefix with timeStamp"),t.keyPrefix=Ze.toString()),new e(t)}};var Oi=new bo;var Ac=new M("I18n"),Di=class{constructor(){this._options=null,this._lang=null,this._dict={}}setDefaultLanguage(){!this._lang&&typeof window<"u"&&window&&window.navigator&&(this._lang=window.navigator.language),Ac.debug(this._lang)}setLanguage(t){this._lang=t}get(t,o=void 0){if(this.setDefaultLanguage(),!this._lang)return typeof o<"u"?o:t;let r=this._lang,n=this.getByLanguage(t,r);return n||(r.indexOf("-")>0&&(n=this.getByLanguage(t,r.split("-")[0])),n)?n:typeof o<"u"?o:t}getByLanguage(t,o,r=null){if(!o)return r;let n=this._dict[o];return n?n[t]:r}putVocabulariesForLanguage(t,o){let r=this._dict[t];r||(r=this._dict[t]={}),this._dict[t]=u(u({},r),o)}putVocabularies(t){Object.keys(t).forEach(o=>{this.putVocabulariesForLanguage(o,t[o])})}};var ft=(function(e){return e.NotConfigured="NotConfigured",e})(ft||{}),Cc={[ft.NotConfigured]:{message:"i18n is not configured."}},Zt=Pe(Cc);var Mi=new M("I18n"),Oo={language:null},Te=null,Qt=class e{static configure(t){return Mi.debug("configure I18n"),t&&(Oo=Object.assign({},Oo,t.I18n||t),e.createInstance()),Oo}static getModuleName(){return"I18n"}static createInstance(){Mi.debug("create I18n instance"),!Te&&(Te=new Di)}static setLanguage(t){e.checkConfig(),Zt(!!Te,ft.NotConfigured),Te.setLanguage(t)}static get(t,o){return e.checkConfig()?(Zt(!!Te,ft.NotConfigured),Te.get(t,o)):typeof o>"u"?t:o}static putVocabulariesForLanguage(t,o){e.checkConfig(),Zt(!!Te,ft.NotConfigured),Te.putVocabulariesForLanguage(t,o)}static putVocabularies(t){e.checkConfig(),Zt(!!Te,ft.NotConfigured),Te.putVocabularies(t)}static checkConfig(){return Te||e.createInstance(),!0}};Qt.createInstance();var Dr=e=>{let t="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",o=[],r=new Uint8Array(e);st().getRandomValues(r);for(let n of r)o.push(t[n%t.length]);return o.join("")};function Mr(e){return(e.match(/.{2}/g)||[]).map(o=>String.fromCharCode(parseInt(o,16))).join("")}function kr(e){return e.split("").map(t=>t.charCodeAt(0).toString(16).padStart(2,"0")).join("")}var Fr=e=>{let t;return async(...o)=>t||(t=new Promise((r,n)=>{e(...o).then(i=>{r(i)}).catch(i=>{n(i)}).finally(()=>{t=void 0})}),t)};function Do({expiresAt:e,clockDrift:t,tolerance:o=5e3}){return Date.now()+t+o>e}var Lr=async()=>{let{userAgentData:e}=navigator;if(!e)return navigator.userAgent;let{platform:t="",platformVersion:o="",model:r="",architecture:n="",fullVersionList:i=[]}=await e.getHighEntropyValues(["platform","platformVersion","architecture","model","fullVersionList"]),s=i.map(c=>`${c.brand}/${c.version}`).join(";");return[t,o,n,r,t,s].filter(c=>c).join(" ")||navigator.userAgent};function ki(e){return Array.from(e,t=>String.fromCodePoint(t)).join("")}var ye={convert(e,t={urlSafe:!1,skipPadding:!1}){let o=typeof e=="string"?e:ki(e),r=Dn()(o);return t.urlSafe&&(r=r.replace(/\+/g,"-").replace(/\//g,"_")),t.skipPadding&&(r=r.replace(/=/g,"")),r}};function Fi(){return st().getRandomValues(new Uint32Array(1))[0]}function xc(e){let{words:t}=e,{sigBytes:o}=e,r=[];for(let n=0;n<o;n++){let i=t[n>>>2]>>>24-n%4*8&255;r.push((i>>>4).toString(16)),r.push((i&15).toString(16))}return r.join("")}var eo=class e{constructor(t,o){this.words=[];let r=t;r=this.words=r||[],o!==void 0?this.sigBytes=o:this.sigBytes=r.length*4}random(t){let o=[];for(let r=0;r<t;r+=4)o.push(Fi());return new e(o,t)}toString(){return xc(this)}};var y=(function(e){return e.EmptySignInUsername="EmptySignInUsername",e.EmptySignInPassword="EmptySignInPassword",e.CustomAuthSignInPassword="CustomAuthSignInPassword",e.EmptySignUpUsername="EmptySignUpUsername",e.EmptySignUpPassword="EmptySignUpPassword",e.EmptyConfirmSignUpUsername="EmptyConfirmSignUpUsername",e.EmptyConfirmSignUpCode="EmptyConfirmSignUpCode",e.EmptyResendSignUpCodeUsername="EmptyresendSignUpCodeUsername",e.EmptyChallengeResponse="EmptyChallengeResponse",e.EmptyConfirmResetPasswordUsername="EmptyConfirmResetPasswordUsername",e.EmptyConfirmResetPasswordNewPassword="EmptyConfirmResetPasswordNewPassword",e.EmptyConfirmResetPasswordConfirmationCode="EmptyConfirmResetPasswordConfirmationCode",e.EmptyResetPasswordUsername="EmptyResetPasswordUsername",e.EmptyVerifyTOTPSetupCode="EmptyVerifyTOTPSetupCode",e.EmptyConfirmUserAttributeCode="EmptyConfirmUserAttributeCode",e.IncorrectMFAMethod="IncorrectMFAMethod",e.EmptyUpdatePassword="EmptyUpdatePassword",e})(y||{});var Mo={[y.EmptyChallengeResponse]:{message:"challengeResponse is required to confirmSignIn"},[y.EmptyConfirmResetPasswordUsername]:{message:"username is required to confirmResetPassword"},[y.EmptyConfirmSignUpCode]:{message:"code is required to confirmSignUp"},[y.EmptyConfirmSignUpUsername]:{message:"username is required to confirmSignUp"},[y.EmptyConfirmResetPasswordConfirmationCode]:{message:"confirmationCode is required to confirmResetPassword"},[y.EmptyConfirmResetPasswordNewPassword]:{message:"newPassword is required to confirmResetPassword"},[y.EmptyResendSignUpCodeUsername]:{message:"username is required to confirmSignUp"},[y.EmptyResetPasswordUsername]:{message:"username is required to resetPassword"},[y.EmptySignInPassword]:{message:"password is required to signIn"},[y.EmptySignInUsername]:{message:"username is required to signIn"},[y.EmptySignUpPassword]:{message:"password is required to signUp"},[y.EmptySignUpUsername]:{message:"username is required to signUp"},[y.CustomAuthSignInPassword]:{message:"A password is not needed when signing in with CUSTOM_WITHOUT_SRP",recoverySuggestion:"Do not include a password in your signIn call."},[y.IncorrectMFAMethod]:{message:"Incorrect MFA method was chosen. It should be either SMS, TOTP, or EMAIL",recoverySuggestion:"Try to pass SMS, TOTP, or EMAIL as the challengeResponse"},[y.EmptyVerifyTOTPSetupCode]:{message:"code is required to verifyTotpSetup"},[y.EmptyUpdatePassword]:{message:"oldPassword and newPassword are required to changePassword"},[y.EmptyConfirmUserAttributeCode]:{message:"confirmation code is required to confirmUserAttribute"}},J=(function(e){return e.DEFAULT_MSG="Authentication Error",e.EMPTY_EMAIL="Email cannot be empty",e.EMPTY_PHONE="Phone number cannot be empty",e.EMPTY_USERNAME="Username cannot be empty",e.INVALID_USERNAME="The username should either be a string or one of the sign in types",e.EMPTY_PASSWORD="Password cannot be empty",e.EMPTY_CODE="Confirmation code cannot be empty",e.SIGN_UP_ERROR="Error creating account",e.NO_MFA="No valid MFA method provided",e.INVALID_MFA="Invalid MFA type",e.EMPTY_CHALLENGE="Challenge response cannot be empty",e.NO_USER_SESSION="Failed to get the session because the user is empty",e.NETWORK_ERROR="Network Error",e.DEVICE_CONFIG="Device tracking has not been configured in this User Pool",e.AUTOSIGNIN_ERROR="Please use your credentials to sign in",e.OAUTH_ERROR="Couldn't finish OAuth flow, check your User Pool HostedUI settings",e})(J||{}),he=(function(e){return e.SignInException="SignInException",e.OAuthSignInError="OAuthSignInException",e})(he||{});var f=class e extends H{constructor(t){super(t),this.constructor=e,Object.setPrototypeOf(this,e.prototype)}};function _(e,t){let{message:o,recoverySuggestion:r}=Mo[t];if(!e)throw new f({name:t,message:o,recoverySuggestion:r})}function C(e){let t=e?.split("_")[0];if(!e||e.indexOf("_")<0||!t||typeof t!="string")throw new f({name:"InvalidUserPoolId",message:"Invalid user pool id provided."});return t}function to(e){if(!e||!e.includes(":"))throw new f({name:"InvalidIdentityPoolIdException",message:"Invalid identity pool id provided.",recoverySuggestion:"Make sure a valid identityPoolId is given in the config."});return e.split(":")[0]}function Hr(e){return Object.entries(e).map(([t,o])=>({Name:t,Value:o}))}function Li(e){let t={};return e?.forEach(o=>{o.Name&&(t[o.Name]=o.Value)}),t}var ko=(function(e){return e.PasswordResetRequiredException="PasswordResetRequiredException",e.ForbiddenException="ForbiddenException",e.InternalErrorException="InternalErrorException",e.InvalidLambdaResponseException="InvalidLambdaResponseException",e.InvalidParameterException="InvalidParameterException",e.InvalidSmsRoleAccessPolicyException="InvalidSmsRoleAccessPolicyException",e.InvalidSmsRoleTrustRelationshipException="InvalidSmsRoleTrustRelationshipException",e.InvalidUserPoolConfigurationException="InvalidUserPoolConfigurationException",e.NotAuthorizedException="NotAuthorizedException",e.ResourceNotFoundException="ResourceNotFoundException",e.TooManyRequestsException="TooManyRequestsException",e.UnexpectedLambdaException="UnexpectedLambdaException",e.UserLambdaValidationException="UserLambdaValidationException",e.UserNotConfirmedException="UserNotConfirmedException",e.UserNotFoundException="UserNotFoundException",e})(ko||{});var Br=(function(e){return e.CodeDeliveryFailureException="CodeDeliveryFailureException",e.InternalErrorException="InternalErrorException",e.InvalidEmailRoleAccessPolicyException="InvalidEmailRoleAccessPolicyException",e.InvalidLambdaResponseException="InvalidLambdaResponseException",e.InvalidParameterException="InvalidParameterException",e.InvalidPasswordException="InvalidPasswordException",e.InvalidSmsRoleAccessPolicyException="InvalidSmsRoleAccessPolicyException",e.InvalidSmsRoleTrustRelationshipException="InvalidSmsRoleTrustRelationshipException",e.NotAuthorizedException="NotAuthorizedException",e.ResourceNotFoundException="ResourceNotFoundException",e.TooManyRequestsException="TooManyRequestsException",e.UnexpectedLambdaException="UnexpectedLambdaException",e.UserLambdaValidationException="UserLambdaValidationException",e.UsernameExistsException="UsernameExistsException",e})(Br||{});var Ct="UserUnAuthenticatedException",Hi="UserAlreadyAuthenticatedException",Bi="DeviceMetadataNotFoundException",Fo="AutoSignInException",wc="InvalidRedirectException",Pc="InvalidAppSchemeException",vc="InvalidPreferredRedirectUrlException",Wi=new f({name:wc,message:"signInRedirect or signOutRedirect had an invalid format or was not found.",recoverySuggestion:"Please make sure the signIn/Out redirect in your oauth config is valid."}),rE=new f({name:Pc,message:"A valid non-http app scheme was not found in the config.",recoverySuggestion:"Please make sure a valid custom app scheme is present in the config."}),Vi=new f({name:vc,message:"The given preferredRedirectUrl does not match any items in the redirectSignOutUrls array from the config.",recoverySuggestion:"Please make sure a matching preferredRedirectUrl is provided."}),Tc="InvalidOriginException",Ki=new f({name:Tc,message:"redirect is coming from a different origin. The oauth flow needs to be initiated from the same origin",recoverySuggestion:"Please call signInWithRedirect from the same origin."}),zi="OAuthSignOutException",qi="TokenRefreshException",Gi="UnexpectedSignInInterruptionException";function xt(e){if(!e||!e.accessToken)throw new f({name:Ct,message:"User needs to be authenticated to call this API.",recoverySuggestion:"Sign in before calling this API again."})}function $i(e){if(!e||!e.idToken)throw new f({name:Ct,message:"User needs to be authenticated to call this API.",recoverySuggestion:"Sign in before calling this API again."})}var Rc=new f({name:qi,message:`Token refresh is not supported when authenticated with the 'implicit grant' (token) oauth flow. 
	Please change your oauth configuration to use 'code grant' flow.`,recoverySuggestion:`Please logout and change your Amplify configuration to use "code grant" flow. 
	E.g { responseType: 'code' }`}),_c=new f({name:Ct,message:"User needs to be authenticated to call this API.",recoverySuggestion:"Sign in before calling this API again."});function Lo(e){if(Uc(e))throw Rc;if(!Nc(e))throw _c}function Wr(e){if(!e||!e.deviceKey||!e.deviceGroupKey||!e.randomPassword)throw new f({name:Bi,message:"Either deviceKey, deviceGroupKey or secretPassword were not found during the sign-in process.",recoverySuggestion:"Make sure to not clear storage after calling the signIn API."})}var ji={inflightOAuth:"inflightOAuth",oauthSignIn:"oauthSignIn",oauthPKCE:"oauthPKCE",oauthState:"oauthState"};function Yi(e){return e?.accessToken||e?.idToken}function Nc(e){return Yi(e)&&e?.refreshToken}function Uc(e){return Yi(e)&&!e?.refreshToken}var Ji=async e=>{let t=e.getConfig().Auth?.Cognito;I(t);let o=await e.Auth.getTokens({forceRefresh:!1});xt(o);let{"cognito:username":r,sub:n}=o.idToken?.payload??{},i={username:r,userId:n},s=bc(o);return s&&(i.signInDetails=s),i};function bc(e){return e?.signInDetails}var Ho=async()=>Ji(A);var P=(e,t)=>Ve(u({category:po.Auth,action:e},t));var b=e=>(t,o)=>{let r=Oc(e),n=JSON.stringify(t);return Dc(o,r,n)},Oc=e=>({"content-type":"application/x-amz-json-1.1","x-amz-target":`AWSCognitoIdentityProviderService.${e}`}),Dc=({url:e},t,o)=>({headers:t,url:e,body:o,method:"POST"});function B(e){if(!e||e.name==="Error"||e instanceof TypeError)throw new f({name:ae.Unknown,message:"An unknown error has occurred.",underlyingError:e})}var k=()=>async e=>{if(e.statusCode>=300){let t=await fe(e);throw B(t),new f({name:t.name,message:t.message,metadata:t.$metadata})}return Ue(e)};var Mc=()=>(e,t)=>async function(r){return r.headers["cache-control"]="no-store",e(r)},O=mt(Yt,[Mc]);var Bo="cognito-idp";var D={service:Bo,retryDecider:jt(fe),computeDelay:$t,get userAgentValue(){return Ve()},cache:"no-store"};var Qe=e=>N(O,b("InitiateAuth"),k(),u(u({},D),e));var q=e=>N(O,b("RespondToAuthChallenge"),k(),u(u({},D),e));var Xi=e=>N(O,b("VerifySoftwareToken"),k(),u(u({},D),e));var Zi=e=>N(O,b("AssociateSoftwareToken"),k(),u(u({},D),e));var Qi=({region:e})=>({url:new ne(`https://${Bo}.${e}.${Jt(e)}`)});var x=({endpointOverride:e})=>t=>e?{url:new ne(e)}:Qi(t);var es=e=>N(O,b("GetTokensFromRefreshToken"),k(),u(u({},D),e));var kc=async({tokens:e,authConfig:t,username:o})=>{I(t?.Cognito);let{userPoolId:r,userPoolClientId:n,userPoolEndpoint:i}=t.Cognito,s=C(r);Lo(e);let a=es({endpointResolver:x({endpointOverride:i})}),{AuthenticationResult:c}=await a({region:s},{ClientId:n,RefreshToken:e.refreshToken,DeviceKey:e.deviceMetadata?.deviceKey}),d=Z(c?.AccessToken??""),m=c?.IdToken?Z(c.IdToken):void 0,{iat:p}=d.payload;if(!p)throw new f({name:"iatNotFoundException",message:"iat not found in access token"});let l=p*1e3-new Date().getTime();return{accessToken:d,idToken:m,clockDrift:l,refreshToken:c?.RefreshToken??e.refreshToken,username:o}},ts=Fr(kc);var os={accessToken:"accessToken",idToken:"idToken",oidcProvider:"oidcProvider",clockDrift:"clockDrift",refreshToken:"refreshToken",deviceKey:"deviceKey",randomPasswordKey:"randomPasswordKey",deviceGroupKey:"deviceGroupKey",signInDetails:"signInDetails",oauthMetadata:"oauthMetadata"};var Wo=(function(e){return e.InvalidAuthTokens="InvalidAuthTokens",e})(Wo||{}),Fc={[Wo.InvalidAuthTokens]:{message:"Invalid tokens.",recoverySuggestion:"Make sure the tokens are valid."}},rs=Pe(Fc);var Vr="CognitoIdentityServiceProvider";var Vo=class{getKeyValueStorage(){if(!this.keyValueStorage)throw new f({name:"KeyValueStorageNotFoundException",message:"KeyValueStorage was not found in TokenStore"});return this.keyValueStorage}setKeyValueStorage(t){this.keyValueStorage=t}setAuthConfig(t){this.authConfig=t}async loadTokens(){try{let t=await this.getAuthKeys(),o=await this.getKeyValueStorage().getItem(t.accessToken);if(!o)throw new f({name:"NoSessionFoundException",message:"Auth session was not found. Make sure to call signIn."});let r=Z(o),n=await this.getKeyValueStorage().getItem(t.idToken),i=n?Z(n):void 0,s=await this.getKeyValueStorage().getItem(t.refreshToken)??void 0,a=await this.getKeyValueStorage().getItem(t.clockDrift)??"0",c=Number.parseInt(a),d=await this.getKeyValueStorage().getItem(t.signInDetails),m={accessToken:r,idToken:i,refreshToken:s,deviceMetadata:await this.getDeviceMetadata()??void 0,clockDrift:c,username:await this.getLastAuthUser()};return d&&(m.signInDetails=JSON.parse(d)),m}catch{return null}}async storeTokens(t){rs(t!==void 0,Wo.InvalidAuthTokens);let o=t.username;await this.getKeyValueStorage().setItem(this.getLastAuthUserKey(),o);let r=await this.getAuthKeys();await this.getKeyValueStorage().setItem(r.accessToken,t.accessToken.toString()),t.idToken?await this.getKeyValueStorage().setItem(r.idToken,t.idToken.toString()):await this.getKeyValueStorage().removeItem(r.idToken),t.refreshToken?await this.getKeyValueStorage().setItem(r.refreshToken,t.refreshToken):await this.getKeyValueStorage().removeItem(r.refreshToken),t.deviceMetadata&&(t.deviceMetadata.deviceKey&&await this.getKeyValueStorage().setItem(r.deviceKey,t.deviceMetadata.deviceKey),t.deviceMetadata.deviceGroupKey&&await this.getKeyValueStorage().setItem(r.deviceGroupKey,t.deviceMetadata.deviceGroupKey),await this.getKeyValueStorage().setItem(r.randomPasswordKey,t.deviceMetadata.randomPassword)),t.signInDetails?await this.getKeyValueStorage().setItem(r.signInDetails,JSON.stringify(t.signInDetails)):await this.getKeyValueStorage().removeItem(r.signInDetails),await this.getKeyValueStorage().setItem(r.clockDrift,`${t.clockDrift}`)}async clearTokens(){let t=await this.getAuthKeys();await Promise.all([this.getKeyValueStorage().removeItem(t.accessToken),this.getKeyValueStorage().removeItem(t.idToken),this.getKeyValueStorage().removeItem(t.clockDrift),this.getKeyValueStorage().removeItem(t.refreshToken),this.getKeyValueStorage().removeItem(t.signInDetails),this.getKeyValueStorage().removeItem(this.getLastAuthUserKey()),this.getKeyValueStorage().removeItem(t.oauthMetadata)])}async getDeviceMetadata(t){let o=await this.getAuthKeys(t),r=await this.getKeyValueStorage().getItem(o.deviceKey),n=await this.getKeyValueStorage().getItem(o.deviceGroupKey),i=await this.getKeyValueStorage().getItem(o.randomPasswordKey);return i&&n&&r?{deviceKey:r,deviceGroupKey:n,randomPassword:i}:null}async clearDeviceMetadata(t){let o=await this.getAuthKeys(t);await Promise.all([this.getKeyValueStorage().removeItem(o.deviceKey),this.getKeyValueStorage().removeItem(o.deviceGroupKey),this.getKeyValueStorage().removeItem(o.randomPasswordKey)])}async getAuthKeys(t){I(this.authConfig?.Cognito);let o=t??await this.getLastAuthUser();return Lc(Vr,`${this.authConfig.Cognito.userPoolClientId}.${o}`)}getLastAuthUserKey(){I(this.authConfig?.Cognito);let t=this.authConfig.Cognito.userPoolClientId;return`${Vr}.${t}.LastAuthUser`}async getLastAuthUser(){return await this.getKeyValueStorage().getItem(this.getLastAuthUserKey())??"username"}async setOAuthMetadata(t){let{oauthMetadata:o}=await this.getAuthKeys();await this.getKeyValueStorage().setItem(o,JSON.stringify(t))}async getOAuthMetadata(){let{oauthMetadata:t}=await this.getAuthKeys(),o=await this.getKeyValueStorage().getItem(t);return o&&JSON.parse(o)}},Lc=(e,t)=>oo(os)(`${e}`,t);function oo(e){let t=Object.values(u({},e));return(o,r)=>t.reduce((n,i)=>S(u({},n),{[i]:`${o}.${r}.${i}`}),{})}var ns="amplify-signin-with-hostedUI",Oe="CognitoIdentityServiceProvider",wt=class{constructor(t){this.keyValueStorage=t}async clearOAuthInflightData(){I(this.cognitoConfig);let t=De(Oe,this.cognitoConfig.userPoolClientId);await Promise.all([this.keyValueStorage.removeItem(t.inflightOAuth),this.keyValueStorage.removeItem(t.oauthPKCE),this.keyValueStorage.removeItem(t.oauthState)])}async clearOAuthData(){I(this.cognitoConfig);let t=De(Oe,this.cognitoConfig.userPoolClientId);return await this.clearOAuthInflightData(),await this.keyValueStorage.removeItem(ns),this.keyValueStorage.removeItem(t.oauthSignIn)}loadOAuthState(){I(this.cognitoConfig);let t=De(Oe,this.cognitoConfig.userPoolClientId);return this.keyValueStorage.getItem(t.oauthState)}storeOAuthState(t){I(this.cognitoConfig);let o=De(Oe,this.cognitoConfig.userPoolClientId);return this.keyValueStorage.setItem(o.oauthState,t)}loadPKCE(){I(this.cognitoConfig);let t=De(Oe,this.cognitoConfig.userPoolClientId);return this.keyValueStorage.getItem(t.oauthPKCE)}storePKCE(t){I(this.cognitoConfig);let o=De(Oe,this.cognitoConfig.userPoolClientId);return this.keyValueStorage.setItem(o.oauthPKCE,t)}setAuthConfig(t){this.cognitoConfig=t}async loadOAuthInFlight(){I(this.cognitoConfig);let t=De(Oe,this.cognitoConfig.userPoolClientId);return await this.keyValueStorage.getItem(t.inflightOAuth)==="true"}async storeOAuthInFlight(t){I(this.cognitoConfig);let o=De(Oe,this.cognitoConfig.userPoolClientId);await this.keyValueStorage.setItem(o.inflightOAuth,`${t}`)}async loadOAuthSignIn(){I(this.cognitoConfig);let t=De(Oe,this.cognitoConfig.userPoolClientId),o=await this.keyValueStorage.getItem(ns),[r,n]=(await this.keyValueStorage.getItem(t.oauthSignIn))?.split(",")??[];return{isOAuthSignIn:r==="true"||o==="true",preferPrivateSession:n==="true"}}async storeOAuthSignIn(t,o=!1){I(this.cognitoConfig);let r=De(Oe,this.cognitoConfig.userPoolClientId);await this.keyValueStorage.setItem(r.oauthSignIn,`${t},${o}`)}},De=(e,t)=>oo(ji)(e,t);var G=new wt(Ie);var Kr=[],is=e=>{Kr.push(e)},Ko=()=>{for(;Kr.length;)Kr.pop()?.()};var zo=class{constructor(){this.waitForInflightOAuth=Ke()?async()=>{if(await G.loadOAuthInFlight())return this.inflightPromise?this.inflightPromise:(this.inflightPromise=new Promise((t,o)=>{is(t)}),this.inflightPromise)}:async()=>{}}setAuthConfig(t){G.setAuthConfig(t.Cognito),this.authConfig=t}setTokenRefresher(t){this.tokenRefresher=t}setAuthTokenStore(t){this.tokenStore=t}getTokenStore(){if(!this.tokenStore)throw new f({name:"EmptyTokenStoreException",message:"TokenStore not set"});return this.tokenStore}getTokenRefresher(){if(!this.tokenRefresher)throw new f({name:"EmptyTokenRefresherException",message:"TokenRefresher not set"});return this.tokenRefresher}async getTokens(t){let o;try{I(this.authConfig?.Cognito)}catch{return null}await this.waitForInflightOAuth(),this.inflightPromise=void 0,o=await this.getTokenStore().loadTokens();let r=await this.getTokenStore().getLastAuthUser();if(o===null)return null;let n=!!o?.idToken&&Do({expiresAt:(o.idToken?.payload?.exp??0)*1e3,clockDrift:o.clockDrift??0}),i=Do({expiresAt:(o.accessToken?.payload?.exp??0)*1e3,clockDrift:o.clockDrift??0});return(t?.forceRefresh||n||i)&&(o=await this.refreshTokens({tokens:o,username:r}),o===null)?null:{accessToken:o?.accessToken,idToken:o?.idToken,signInDetails:o?.signInDetails}}async refreshTokens({tokens:t,username:o}){try{let{signInDetails:r}=t,n=await this.getTokenRefresher()({tokens:t,authConfig:this.authConfig,username:o});return n.signInDetails=r,await this.setTokens({tokens:n}),z.dispatch("auth",{event:"tokenRefresh"},"Auth",Y),n}catch(r){return this.handleErrors(r)}}handleErrors(t){if(B(t),t.name!==ae.NetworkError&&this.clearTokens(),z.dispatch("auth",{event:"tokenRefresh_failure",data:{error:t}},"Auth",Y),t.name.startsWith("NotAuthorizedException"))return null;throw t}async setTokens({tokens:t}){return this.getTokenStore().storeTokens(t)}async clearTokens(){return this.getTokenStore().clearTokens()}getDeviceMetadata(t){return this.getTokenStore().getDeviceMetadata(t)}clearDeviceMetadata(t){return this.getTokenStore().clearDeviceMetadata(t)}setOAuthMetadata(t){return this.getTokenStore().setOAuthMetadata(t)}getOAuthMetadata(){return this.getTokenStore().getOAuthMetadata()}};var qo=class{constructor(){this.authTokenStore=new Vo,this.authTokenStore.setKeyValueStorage(Ie),this.tokenOrchestrator=new zo,this.tokenOrchestrator.setAuthTokenStore(this.authTokenStore),this.tokenOrchestrator.setTokenRefresher(ts)}getTokens({forceRefresh:t}={forceRefresh:!1}){return this.tokenOrchestrator.getTokens({forceRefresh:t})}setKeyValueStorage(t){this.authTokenStore.setKeyValueStorage(t)}setAuthConfig(t){this.authTokenStore.setAuthConfig(t),this.tokenOrchestrator.setAuthConfig(t)}};var ht=new qo,{tokenOrchestrator:L}=ht;async function ee(e){if(e.AccessToken){let t=Z(e.AccessToken),o=(t.payload.iat||0)*1e3,r=new Date().getTime(),n=o>0?o-r:0,i,s,a;e.RefreshToken&&(s=e.RefreshToken),e.IdToken&&(i=Z(e.IdToken)),e?.NewDeviceMetadata&&(a=e.NewDeviceMetadata);let c={accessToken:t,idToken:i,refreshToken:s,clockDrift:n,deviceMetadata:a,username:e.username};e?.signInDetails&&(c.signInDetails=e.signInDetails),await L.setTokens({tokens:c})}else throw new H({message:"Invalid tokens",name:"InvalidTokens",recoverySuggestion:"Check Cognito UserPool settings"})}var Hc="Unable to get user session following successful sign-in.",oe=async()=>{try{z.dispatch("auth",{event:"signedIn",data:await Ho()},"Auth",Y)}catch(e){throw e.name===Ct?new f({name:Gi,message:Hc,recoverySuggestion:"This most likely is due to auth tokens not being persisted. If you are using cookie store, please ensure cookies can be correctly set from your server."}):e}};function ss(){return{active:!1}}var Bc=(e,t)=>{switch(t.type){case"SET_USERNAME":return S(u({},e),{username:t.value});case"SET_SESSION":return S(u({},e),{session:t.value});case"START":return S(u({},e),{active:!0});case"RESET":return ss();default:return e}},Wc=e=>{let t=e(ss(),{type:"RESET"});return{getState:()=>t,dispatch:o=>{t=e(t,o)}}},Ae=Wc(Bc);var Vc=180*1e3,Go="CognitoSignInState",Ge={username:`${Go}.username`,challengeName:`${Go}.challengeName`,signInSession:`${Go}.signInSession`,expiry:`${Go}.expiry`},Kc=(e,t)=>{switch(t.type){case"SET_SIGN_IN_SESSION":return $o({signInSession:t.value}),S(u({},e),{signInSession:t.value});case"SET_SIGN_IN_STATE":return $o(t.value),u({},t.value);case"SET_CHALLENGE_NAME":return $o({challengeName:t.value}),S(u({},e),{challengeName:t.value});case"SET_USERNAME":return $o({username:t.value}),S(u({},e),{username:t.value});case"SET_INITIAL_STATE":return qc();case"RESET_STATE":return as(),zr();default:return e}},zc=e=>{let t=Number(e),o=Date.now();return t<=o},te=()=>{de.dispatch({type:"RESET_STATE"})},as=()=>{for(let e of Object.values(Ge))ve.removeItem(e)},zr=()=>({username:void 0,challengeName:void 0,signInSession:void 0}),qc=()=>{let e=ve.getItem(Ge.expiry);if(!e||zc(e))return as(),zr();let t=ve.getItem(Ge.username)??void 0,o=ve.getItem(Ge.challengeName)??void 0,r=ve.getItem(Ge.signInSession)??void 0;return{username:t,challengeName:o,signInSession:r}},Gc=e=>{let t=e(zr(),{type:"SET_INITIAL_STATE"});return{getState:()=>t,dispatch:o=>{t=e(t,o)}}},de=Gc(Kc);function me(e){de.dispatch({type:"SET_SIGN_IN_STATE",value:e})}var $o=({challengeName:e,signInSession:t,username:o})=>{o&&ve.setItem(Ge.username,o),e&&ve.setItem(Ge.challengeName,e),t&&(ve.setItem(Ge.signInSession,t),ve.setItem(Ge.expiry,String(Date.now()+Vc)))};var et=class e extends H{constructor(t){super(t),this.constructor=e,Object.setPrototypeOf(this,e.prototype)}},W=(function(e){return e.PasskeyNotSupported="PasskeyNotSupported",e.PasskeyAlreadyExists="PasskeyAlreadyExists",e.InvalidPasskeyRegistrationOptions="InvalidPasskeyRegistrationOptions",e.InvalidPasskeyAuthenticationOptions="InvalidPasskeyAuthenticationOptions",e.RelyingPartyMismatch="RelyingPartyMismatch",e.PasskeyRegistrationFailed="PasskeyRegistrationFailed",e.PasskeyRetrievalFailed="PasskeyRetrievalFailed",e.PasskeyRegistrationCanceled="PasskeyRegistrationCanceled",e.PasskeyAuthenticationCanceled="PasskeyAuthenticationCanceled",e.PasskeyOperationAborted="PasskeyOperationAborted",e})(W||{}),cs="Passkeys may not be supported on this device. Ensure your application is running in a secure context (HTTPS) and Web Authentication API is supported.",qr="User may have canceled the ceremony or another interruption has occurred. Check underlying error for details.",ds="Ensure your user pool is configured to support the WEB_AUTHN as an authentication factor.",jo={[W.PasskeyNotSupported]:{message:"Passkeys may not be supported on this device.",recoverySuggestion:cs},[W.InvalidPasskeyRegistrationOptions]:{message:"Invalid passkey registration options.",recoverySuggestion:ds},[W.InvalidPasskeyAuthenticationOptions]:{message:"Invalid passkey authentication options.",recoverySuggestion:ds},[W.PasskeyRegistrationFailed]:{message:"Device failed to create passkey.",recoverySuggestion:cs},[W.PasskeyRetrievalFailed]:{message:"Device failed to retrieve passkey.",recoverySuggestion:"Passkeys may not be available on this device. Try an alternative authentication factor like PASSWORD, EMAIL_OTP, or SMS_OTP."},[W.PasskeyAlreadyExists]:{message:"Passkey already exists in authenticator.",recoverySuggestion:"Proceed with existing passkey or try again after deleting the credential."},[W.PasskeyRegistrationCanceled]:{message:"Passkey registration ceremony has been canceled.",recoverySuggestion:qr},[W.PasskeyAuthenticationCanceled]:{message:"Passkey authentication ceremony has been canceled.",recoverySuggestion:qr},[W.PasskeyOperationAborted]:{message:"Passkey operation has been aborted.",recoverySuggestion:qr},[W.RelyingPartyMismatch]:{message:"Relying party does not match current domain.",recoverySuggestion:"Ensure relying party identifier matches current domain."}},Pt=Pe(jo,et),ms=e=>{if(e instanceof et)return e;if(e instanceof Error&&e.name==="NotAllowedError"){let{message:t,recoverySuggestion:o}=jo[W.PasskeyAuthenticationCanceled];return new et({name:W.PasskeyAuthenticationCanceled,message:t,recoverySuggestion:o,underlyingError:e})}return $c(e)};var $c=e=>{if(e instanceof Error){if(e.name==="AbortError"){let{message:t,recoverySuggestion:o}=jo[W.PasskeyOperationAborted];return new et({name:W.PasskeyOperationAborted,message:t,recoverySuggestion:o,underlyingError:e})}if(e.name==="SecurityError"){let{message:t,recoverySuggestion:o}=jo[W.RelyingPartyMismatch];return new et({name:W.RelyingPartyMismatch,message:t,recoverySuggestion:o,underlyingError:e})}}return new et({name:ae.Unknown,message:"An unknown error has occurred.",underlyingError:e})};var us=()=>Ke()&&window.isSecureContext&&"credentials"in navigator&&typeof window.PublicKeyCredential=="function";var vt=e=>ye.convert(new Uint8Array(e),{urlSafe:!0,skipPadding:!0});var Gr=e=>Uint8Array.from(at.convert(e,{urlSafe:!0}),t=>t.charCodeAt(0)).buffer;var ps=e=>{let t=Gr(e.challenge),o=(e.allowCredentials||[]).map(r=>S(u({},r),{id:Gr(r.id)}));return S(u({},e),{challenge:t,allowCredentials:o})},ls=e=>{let t={clientDataJSON:vt(e.response.clientDataJSON),authenticatorData:vt(e.response.authenticatorData),signature:vt(e.response.signature)};e.response.userHandle&&(t.userHandle=vt(e.response.userHandle));let o={id:e.id,rawId:vt(e.rawId),type:e.type,clientExtensionResults:e.getClientExtensionResults(),response:t};return e.authenticatorAttachment&&(o.authenticatorAttachment=e.authenticatorAttachment),o};function fs(e){Pt(e&&e instanceof PublicKeyCredential&&e.response instanceof AuthenticatorAssertionResponse,W.PasskeyRetrievalFailed)}var hs=async e=>{try{let t=us();Pt(t,W.PasskeyNotSupported);let o=ps(e),r=await navigator.credentials.get({publicKey:o});return fs(r),ls(r)}catch(t){throw ms(t)}};var gs=e=>N(O,b("ConfirmDevice"),k(),u(u({},D),e));var Tt={convert(e){return new TextEncoder().encode(e)}};function g(e,t){e!=null&&this.fromString(e,t)}function ie(){return new g(null,null)}var tt,jc=0xdeadbeefcafe,Es=(jc&16777215)===15715070;function Yc(e,t,o,r,n,i){for(;--i>=0;){let s=t*this[e++]+o[r]+n;n=Math.floor(s/67108864),o[r++]=s&67108863}return n}function Jc(e,t,o,r,n,i){let s=t&32767,a=t>>15;for(;--i>=0;){let c=this[e]&32767,d=this[e++]>>15,m=a*c+d*s;c=s*c+((m&32767)<<15)+o[r]+(n&1073741823),n=(c>>>30)+(m>>>15)+a*d+(n>>>30),o[r++]=c&1073741823}return n}function Xc(e,t,o,r,n,i){let s=t&16383,a=t>>14;for(;--i>=0;){let c=this[e]&16383,d=this[e++]>>14,m=a*c+d*s;c=s*c+((m&16383)<<14)+o[r]+n,n=(c>>28)+(m>>14)+a*d,o[r++]=c&268435455}return n}var Ss=typeof navigator<"u";Ss&&Es&&navigator.appName==="Microsoft Internet Explorer"?(g.prototype.am=Jc,tt=30):Ss&&Es&&navigator.appName!=="Netscape"?(g.prototype.am=Yc,tt=26):(g.prototype.am=Xc,tt=28);g.prototype.DB=tt;g.prototype.DM=(1<<tt)-1;g.prototype.DV=1<<tt;var $r=52;g.prototype.FV=Math.pow(2,$r);g.prototype.F1=$r-tt;g.prototype.F2=2*tt-$r;var Zc="0123456789abcdefghijklmnopqrstuvwxyz",Yo=[],Rt,Ce;Rt=48;for(Ce=0;Ce<=9;++Ce)Yo[Rt++]=Ce;Rt=97;for(Ce=10;Ce<36;++Ce)Yo[Rt++]=Ce;Rt=65;for(Ce=10;Ce<36;++Ce)Yo[Rt++]=Ce;function Is(e){return Zc.charAt(e)}function Qc(e,t){let o=Yo[e.charCodeAt(t)];return o??-1}function ed(e){for(let t=this.t-1;t>=0;--t)e[t]=this[t];e.t=this.t,e.s=this.s}function td(e){this.t=1,this.s=e<0?-1:0,e>0?this[0]=e:e<-1?this[0]=e+this.DV:this.t=0}function jr(e){let t=ie();return t.fromInt(e),t}function od(e,t){let o;if(t===16)o=4;else if(t===8)o=3;else if(t===2)o=1;else if(t===32)o=5;else if(t===4)o=2;else throw new Error("Only radix 2, 4, 8, 16, 32 are supported");this.t=0,this.s=0;let r=e.length,n=!1,i=0;for(;--r>=0;){let s=Qc(e,r);if(s<0){e.charAt(r)==="-"&&(n=!0);continue}n=!1,i===0?this[this.t++]=s:i+o>this.DB?(this[this.t-1]|=(s&(1<<this.DB-i)-1)<<i,this[this.t++]=s>>this.DB-i):this[this.t-1]|=s<<i,i+=o,i>=this.DB&&(i-=this.DB)}this.clamp(),n&&g.ZERO.subTo(this,this)}function rd(){let e=this.s&this.DM;for(;this.t>0&&this[this.t-1]==e;)--this.t}function nd(e){if(this.s<0)return"-"+this.negate().toString(e);let t;if(e==16)t=4;else if(e===8)t=3;else if(e===2)t=1;else if(e===32)t=5;else if(e===4)t=2;else throw new Error("Only radix 2, 4, 8, 16, 32 are supported");let o=(1<<t)-1,r,n=!1,i="",s=this.t,a=this.DB-s*this.DB%t;if(s-- >0)for(a<this.DB&&(r=this[s]>>a)>0&&(n=!0,i=Is(r));s>=0;)a<t?(r=(this[s]&(1<<a)-1)<<t-a,r|=this[--s]>>(a+=this.DB-t)):(r=this[s]>>(a-=t)&o,a<=0&&(a+=this.DB,--s)),r>0&&(n=!0),n&&(i+=Is(r));return n?i:"0"}function id(){let e=ie();return g.ZERO.subTo(this,e),e}function sd(){return this.s<0?this.negate():this}function ad(e){let t=this.s-e.s;if(t!=0)return t;let o=this.t;if(t=o-e.t,t!=0)return this.s<0?-t:t;for(;--o>=0;)if((t=this[o]-e[o])!=0)return t;return 0}function Yr(e){let t=1,o;return(o=e>>>16)!==0&&(e=o,t+=16),(o=e>>8)!==0&&(e=o,t+=8),(o=e>>4)!==0&&(e=o,t+=4),(o=e>>2)!==0&&(e=o,t+=2),(o=e>>1)!==0&&(e=o,t+=1),t}function cd(){return this.t<=0?0:this.DB*(this.t-1)+Yr(this[this.t-1]^this.s&this.DM)}function dd(e,t){let o;for(o=this.t-1;o>=0;--o)t[o+e]=this[o];for(o=e-1;o>=0;--o)t[o]=0;t.t=this.t+e,t.s=this.s}function md(e,t){for(let o=e;o<this.t;++o)t[o-e]=this[o];t.t=Math.max(this.t-e,0),t.s=this.s}function ud(e,t){let o=e%this.DB,r=this.DB-o,n=(1<<r)-1,i=Math.floor(e/this.DB),s=this.s<<o&this.DM,a;for(a=this.t-1;a>=0;--a)t[a+i+1]=this[a]>>r|s,s=(this[a]&n)<<o;for(a=i-1;a>=0;--a)t[a]=0;t[i]=s,t.t=this.t+i+1,t.s=this.s,t.clamp()}function pd(e,t){t.s=this.s;let o=Math.floor(e/this.DB);if(o>=this.t){t.t=0;return}let r=e%this.DB,n=this.DB-r,i=(1<<r)-1;t[0]=this[o]>>r;for(let s=o+1;s<this.t;++s)t[s-o-1]|=(this[s]&i)<<n,t[s-o]=this[s]>>r;r>0&&(t[this.t-o-1]|=(this.s&i)<<n),t.t=this.t-o,t.clamp()}function ld(e,t){let o=0,r=0,n=Math.min(e.t,this.t);for(;o<n;)r+=this[o]-e[o],t[o++]=r&this.DM,r>>=this.DB;if(e.t<this.t){for(r-=e.s;o<this.t;)r+=this[o],t[o++]=r&this.DM,r>>=this.DB;r+=this.s}else{for(r+=this.s;o<e.t;)r-=e[o],t[o++]=r&this.DM,r>>=this.DB;r-=e.s}t.s=r<0?-1:0,r<-1?t[o++]=this.DV+r:r>0&&(t[o++]=r),t.t=o,t.clamp()}function fd(e,t){let o=this.abs(),r=e.abs(),n=o.t;for(t.t=n+r.t;--n>=0;)t[n]=0;for(n=0;n<r.t;++n)t[n+o.t]=o.am(0,r[n],t,n,0,o.t);t.s=0,t.clamp(),this.s!==e.s&&g.ZERO.subTo(t,t)}function hd(e){let t=this.abs(),o=e.t=2*t.t;for(;--o>=0;)e[o]=0;for(o=0;o<t.t-1;++o){let r=t.am(o,t[o],e,2*o,0,1);(e[o+t.t]+=t.am(o+1,2*t[o],e,2*o+1,r,t.t-o-1))>=t.DV&&(e[o+t.t]-=t.DV,e[o+t.t+1]=1)}e.t>0&&(e[e.t-1]+=t.am(o,t[o],e,2*o,0,1)),e.s=0,e.clamp()}function gd(e,t,o){let r=e.abs();if(r.t<=0)return;let n=this.abs();if(n.t<r.t){t?.fromInt(0),o!=null&&this.copyTo(o);return}o===null&&(o=ie());let i=ie(),s=this.s,a=e.s,c=this.DB-Yr(r[r.t-1]);c>0?(r.lShiftTo(c,i),n.lShiftTo(c,o)):(r.copyTo(i),n.copyTo(o));let d=i.t,m=i[d-1];if(m===0)return;let p=m*(1<<this.F1)+(d>1?i[d-2]>>this.F2:0),l=this.FV/p,h=(1<<this.F1)/p,E=1<<this.F2,v=o.t,T=v-d,R=t===null?ie():t;for(i.dlShiftTo(T,R),o.compareTo(R)>=0&&(o[o.t++]=1,o.subTo(R,o)),g.ONE.dlShiftTo(d,R),R.subTo(i,i);i.t<d;)i[i.t++]=0;for(;--T>=0;){let j=o[--v]===m?this.DM:Math.floor(o[v]*l+(o[v-1]+E)*h);if((o[v]+=i.am(0,j,o,T,0,d))<j)for(i.dlShiftTo(T,R),o.subTo(R,o);o[v]<--j;)o.subTo(R,o)}t!==null&&(o.drShiftTo(d,t),s!==a&&g.ZERO.subTo(t,t)),o.t=d,o.clamp(),c>0&&o.rShiftTo(c,o),s<0&&g.ZERO.subTo(o,o)}function Ed(e){let t=ie();return this.abs().divRemTo(e,null,t),this.s<0&&t.compareTo(g.ZERO)>0&&e.subTo(t,t),t}function Sd(){if(this.t<1)return 0;let e=this[0];if((e&1)===0)return 0;let t=e&3;return t=t*(2-(e&15)*t)&15,t=t*(2-(e&255)*t)&255,t=t*(2-((e&65535)*t&65535))&65535,t=t*(2-e*t%this.DV)%this.DV,t>0?this.DV-t:-t}function Id(e){return this.compareTo(e)===0}function yd(e,t){let o=0,r=0,n=Math.min(e.t,this.t);for(;o<n;)r+=this[o]+e[o],t[o++]=r&this.DM,r>>=this.DB;if(e.t<this.t){for(r+=e.s;o<this.t;)r+=this[o],t[o++]=r&this.DM,r>>=this.DB;r+=this.s}else{for(r+=this.s;o<e.t;)r+=e[o],t[o++]=r&this.DM,r>>=this.DB;r+=e.s}t.s=r<0?-1:0,r>0?t[o++]=r:r<-1&&(t[o++]=this.DV+r),t.t=o,t.clamp()}function Ad(e){let t=ie();return this.addTo(e,t),t}function Cd(e){let t=ie();return this.subTo(e,t),t}function xd(e){let t=ie();return this.multiplyTo(e,t),t}function wd(e){let t=ie();return this.divRemTo(e,t,null),t}function _t(e){this.m=e,this.mp=e.invDigit(),this.mpl=this.mp&32767,this.mph=this.mp>>15,this.um=(1<<e.DB-15)-1,this.mt2=2*e.t}function Pd(e){let t=ie();return e.abs().dlShiftTo(this.m.t,t),t.divRemTo(this.m,null,t),e.s<0&&t.compareTo(g.ZERO)>0&&this.m.subTo(t,t),t}function vd(e){let t=ie();return e.copyTo(t),this.reduce(t),t}function Td(e){for(;e.t<=this.mt2;)e[e.t++]=0;for(let t=0;t<this.m.t;++t){let o=e[t]&32767,r=o*this.mpl+((o*this.mph+(e[t]>>15)*this.mpl&this.um)<<15)&e.DM;for(o=t+this.m.t,e[o]+=this.m.am(0,r,e,t,0,this.m.t);e[o]>=e.DV;)e[o]-=e.DV,e[++o]++}e.clamp(),e.drShiftTo(this.m.t,e),e.compareTo(this.m)>=0&&e.subTo(this.m,e)}function Rd(e,t){e.squareTo(t),this.reduce(t)}function _d(e,t,o){e.multiplyTo(t,o),this.reduce(o)}_t.prototype.convert=Pd;_t.prototype.revert=vd;_t.prototype.reduce=Td;_t.prototype.mulTo=_d;_t.prototype.sqrTo=Rd;function Nd(e,t,o){let r=e.bitLength(),n,i=jr(1),s=new _t(t);if(r<=0)return i;r<18?n=1:r<48?n=3:r<144?n=4:r<768?n=5:n=6;let a=[],c=3,d=n-1,m=(1<<n)-1;if(a[1]=s.convert(this),n>1){let R=ie();for(s.sqrTo(a[1],R);c<=m;)a[c]=ie(),s.mulTo(R,a[c-2],a[c]),c+=2}let p=e.t-1,l,h=!0,E=ie(),v;for(r=Yr(e[p])-1;p>=0;){for(r>=d?l=e[p]>>r-d&m:(l=(e[p]&(1<<r+1)-1)<<d-r,p>0&&(l|=e[p-1]>>this.DB+r-d)),c=n;(l&1)===0;)l>>=1,--c;if((r-=c)<0&&(r+=this.DB,--p),h)a[l].copyTo(i),h=!1;else{for(;c>1;)s.sqrTo(i,E),s.sqrTo(E,i),c-=2;c>0?s.sqrTo(i,E):(v=i,i=E,E=v),s.mulTo(E,a[l],i)}for(;p>=0&&(e[p]&1<<r)===0;)s.sqrTo(i,E),v=i,i=E,E=v,--r<0&&(r=this.DB-1,--p)}let T=s.revert(i);return o(null,T),T}g.prototype.copyTo=ed;g.prototype.fromInt=td;g.prototype.fromString=od;g.prototype.clamp=rd;g.prototype.dlShiftTo=dd;g.prototype.drShiftTo=md;g.prototype.lShiftTo=ud;g.prototype.rShiftTo=pd;g.prototype.subTo=ld;g.prototype.multiplyTo=fd;g.prototype.squareTo=hd;g.prototype.divRemTo=gd;g.prototype.invDigit=Sd;g.prototype.addTo=yd;g.prototype.toString=nd;g.prototype.negate=id;g.prototype.abs=sd;g.prototype.compareTo=ad;g.prototype.bitLength=cd;g.prototype.mod=Ed;g.prototype.equals=Id;g.prototype.add=Ad;g.prototype.subtract=Cd;g.prototype.multiply=xd;g.prototype.divide=wd;g.prototype.modPow=Nd;g.ZERO=jr(0);g.ONE=jr(1);var ys=async({a:e,g:t,k:o,x:r,B:n,N:i,U:s})=>new Promise((a,c)=>{t.modPow(r,i,(d,m)=>{if(d){c(d);return}n.subtract(o.multiply(m)).modPow(e.add(s.multiply(r)),i,(p,l)=>{if(p){c(p);return}a(l.mod(i))})})});var As="FFFFFFFFFFFFFFFFC90FDAA22168C234C4C6628B80DC1CD129024E088A67CC74020BBEA63B139B22514A08798E3404DDEF9519B3CD3A431B302B0A6DF25F14374FE1356D6D51C245E485B576625E7EC6F44C42E9A637ED6B0BFF5CB6F406B7EDEE386BFB5A899FA5AE9F24117C4B1FE649286651ECE45B3DC2007CB8A163BF0598DA48361C55D39A69163FA8FD24CF5F83655D23DCA3AD961C62F356208552BB9ED529077096966D670C354E4ABC9804F1746C08CA18217C32905E462E36CE3BE39E772C180E86039B2783A2EC07A28FB5C55DF06F4C52C9DE2BCBF6955817183995497CEA956AE515D2261898FA051015728E5A8AAAC42DAD33170D04507A33A85521ABDF1CBA64ECFB850458DBEF0A8AEA71575D060C7DB3970F85A6E1E4C7ABF5AE8CDB0933D71E8C94E04A25619DCEE3D2261AD2EE6BF12FFA06D98A0864D87602733EC86A64521F2B18177B200CBBE117577A615D6C770988C0BAD946E208E24FA074E5AB3143DB5BFCE0FD108E4B82D120A93AD2CAFFFFFFFFFFFFFFFF",Jr={},Jo={};for(let e=0;e<256;e++){let t=e.toString(16).toLowerCase();t.length===1&&(t=`0${t}`),Jr[e]=t,Jo[t]=e}var Me=e=>{if(e.length%2!==0)throw new Error("Hex encoded strings must have an even number length");let t=new Uint8Array(e.length/2);for(let o=0;o<e.length;o+=2){let r=e.slice(o,o+2).toLowerCase();if(r in Jo)t[o/2]=Jo[r];else throw new Error(`Cannot decode unrecognized sequence ${r} as hexadecimal`)}return t};var Nt=e=>{let t="";for(let o=0;o<e.byteLength;o++)t+=Jr[e[o]];return t};var ro=e=>{let t=new We;t.update(e);let o=t.digestSync(),r=Nt(o);return new Array(64-r.length).join("0")+r};var Ut=e=>ro(Me(e));var Ud=/^[89a-f]/i,Re=e=>{if(!(e instanceof g))throw new Error("Not a BigInteger");let t=e.compareTo(g.ZERO)<0,o=e.abs().toString(16);if(o=o.length%2!==0?`0${o}`:o,o=Ud.test(o)?`00${o}`:o,t){let r=o.split("").map(i=>{let s=~parseInt(i,16)&15;return"0123456789ABCDEF".charAt(s)}).join("");o=new g(r,16).add(g.ONE).toString(16),o.toUpperCase().startsWith("FF8")&&(o=o.substring(2))}return o};var Cs=({A:e,B:t})=>{let o=new g(Ut(Re(e)+Re(t)),16);if(o.equals(g.ZERO))throw new Error("U cannot be zero.");return o};var xs=(e,t,o)=>{let r=new We(t);r.update(e);let n=r.digestSync(),i=new We(n);return i.update(o),i.digestSync().slice(0,16)};var bt=e=>{let t=new eo().random(e).toString();return Me(t)};var ws=()=>ye.convert(bt(40));var Xo=class{constructor({userPoolName:t,a:o,g:r,A:n,N:i}){this.encoder=Tt,this.userPoolName=t,this.a=o,this.g=r,this.A=n,this.N=i,this.k=new g(Ut(`${Re(i)}${Re(r)}`),16)}getRandomPassword(){if(!this.randomPassword)throw new f({name:"EmptyBigIntegerRandomPassword",message:"random password is empty"});return this.randomPassword}getSaltToHashDevices(){if(!this.saltToHashDevices)throw new f({name:"EmptyBigIntegersaltToHashDevices",message:"saltToHashDevices is empty"});return this.saltToHashDevices}getVerifierDevices(){if(!this.verifierDevices)throw new f({name:"EmptyBigIntegerVerifierDevices",message:"verifyDevices is empty"});return this.verifierDevices}async generateHashDevice(t,o){this.randomPassword=ws();let r=`${t}${o}:${this.randomPassword}`,n=ro(r),i=Nt(bt(16));return this.saltToHashDevices=Re(new g(i,16)),new Promise((s,a)=>{this.g.modPow(new g(Ut(this.saltToHashDevices+n),16),this.N,(c,d)=>{if(c){a(c);return}this.verifierDevices=Re(d),s()})})}async getPasswordAuthenticationKey({username:t,password:o,serverBValue:r,salt:n}){if(r.mod(this.N).equals(g.ZERO))throw new Error("B cannot be zero.");let i=Cs({A:this.A,B:r}),s=`${this.userPoolName}${t}:${o}`,a=ro(s),c=new g(Ut(Re(n)+a),16),d=await ys({a:this.a,g:this.g,k:this.k,x:c,B:r,N:this.N,U:i}),m=this.encoder.convert("Caldera Derived Key"),p=this.encoder.convert(""),l=new Uint8Array(m.byteLength+p.byteLength);return l.set(m,0),l.set(p,m.byteLength),xs(Me(Re(d)),Me(Re(i)),l)}};var Ps=async({a:e,g:t,N:o})=>new Promise((r,n)=>{t.modPow(e,o,(i,s)=>{if(i){n(i);return}if(s.mod(o).equals(g.ZERO)){n(new Error("Illegal parameter. A mod N cannot be 0."));return}r(s)})});var ke=async e=>{let t=new g(As,16),o=new g("2",16),r=bd(),n=await Ps({a:r,g:o,N:t});return new Xo({userPoolName:e,a:r,g:o,A:n,N:t})},bd=()=>{let e=Nt(bt(128));return new g(e,16)};async function ue({userPoolId:e,userPoolEndpoint:t,newDeviceMetadata:o,accessToken:r}){if(!o)return;let n=e.split("_")[1]||"",i=await ke(n),s=o?.DeviceKey,a=o?.DeviceGroupKey;try{await i.generateHashDevice(a??"",s??"")}catch{return}let c={Salt:ye.convert(Me(i.getSaltToHashDevices())),PasswordVerifier:ye.convert(Me(i.getVerifierDevices()))},d=i.getRandomPassword();try{return await gs({endpointResolver:x({endpointOverride:t})})({region:C(e)},{AccessToken:r,DeviceName:await Lr(),DeviceKey:o?.DeviceKey,DeviceSecretVerifierConfig:c}),{deviceKey:s,deviceGroupKey:a,randomPassword:d}}catch{return}}async function vs(e){let t=A.getConfig().Auth?.Cognito;I(t);let{username:o,signInSession:r,signInDetails:n,challengeName:i}=de.getState();if(i!=="WEB_AUTHN"||!o)throw new f({name:he.SignInException,message:"Unable to proceed due to invalid sign in state."});let{CREDENTIAL_REQUEST_OPTIONS:s}=e;Pt(!!s,W.InvalidPasskeyAuthenticationOptions);let a=await hs(JSON.parse(s)),c=q({endpointResolver:x({endpointOverride:t.userPoolEndpoint})}),{ChallengeName:d,ChallengeParameters:m,AuthenticationResult:p,Session:l}=await c({region:C(t.userPoolId),userAgentValue:P(w.ConfirmSignIn)},{ChallengeName:"WEB_AUTHN",ChallengeResponses:{USERNAME:o,CREDENTIAL:JSON.stringify(a)},ClientId:t.userPoolClientId,Session:r});if(me({signInSession:l,username:o,challengeName:d,signInDetails:n}),p)return await ee(S(u({},p),{username:o,NewDeviceMetadata:await ue({userPoolId:t.userPoolId,userPoolEndpoint:t.userPoolEndpoint,newDeviceMetadata:p.NewDeviceMetadata,accessToken:p.AccessToken}),signInDetails:n})),de.dispatch({type:"RESET_STATE"}),await oe(),{isSignedIn:!0,nextStep:{signInStep:"DONE"}};if(d==="WEB_AUTHN")throw new f({name:he.SignInException,message:"Sequential WEB_AUTHN challenges returned from underlying service cannot be handled."});return{challengeName:d,challengeParameters:m}}function U({username:e,userPoolId:t,userPoolClientId:o}){if(typeof window>"u")return;let r=window.AmazonCognitoAdvancedSecurityData;if(typeof r>"u")return;let n=r.getData(e,t,o);return n?{EncodedData:n}:{}}var Od=["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],Dd=["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],Zo=()=>{let e=new Date,t=Dd[e.getUTCDay()],o=Od[e.getUTCMonth()],r=e.getUTCDate(),n=e.getUTCHours();n<10&&(n=`0${n}`);let i=e.getUTCMinutes();i<10&&(i=`0${i}`);let s=e.getUTCSeconds();s<10&&(s=`0${s}`);let a=e.getUTCFullYear();return`${t} ${o} ${r} ${n}:${i}:${s} UTC ${a}`};var Qo=({userPoolName:e,username:t,challengeParameters:o,dateNow:r,hkdf:n})=>{let i=Tt.convert(e),s=Tt.convert(t),a=Md(o.SECRET_BLOCK),c=Tt.convert(r),d=new Uint8Array(i.byteLength+s.byteLength+a.byteLength+c.byteLength);d.set(i,0),d.set(s,i.byteLength),d.set(a,i.byteLength+s.byteLength),d.set(c,i.byteLength+s.byteLength+a.byteLength);let m=new We(n);m.update(d);let p=m.digestSync();return ye.convert(p)},Md=e=>{let t="=".repeat((4-e.length%4)%4),o=(e+t).replace(/-/g,"+").replace(/_/g,"/"),r=at.convert(o),n=new Uint8Array(r.length);for(let i=0;i<r.length;++i)n[i]=r.charCodeAt(i);return n};async function Ot({username:e,config:t,clientMetadata:o,session:r,tokenOrchestrator:n}){let{userPoolId:i,userPoolEndpoint:s}=t,a=t.userPoolClientId,c=await n?.getDeviceMetadata(e);Wr(c);let d=await ke(c.deviceGroupKey),m={USERNAME:e,SRP_A:d.A.toString(16),DEVICE_KEY:c.deviceKey},p={ChallengeName:"DEVICE_SRP_AUTH",ClientId:a,ChallengeResponses:m,ClientMetadata:o,Session:r},l=q({endpointResolver:x({endpointOverride:s})}),{ChallengeParameters:h,Session:E}=await l({region:C(i)},p);return kd(e,h,o,E,d,t,n)}async function kd(e,t,o,r,n,{userPoolId:i,userPoolClientId:s,userPoolEndpoint:a},c){let d=await c?.getDeviceMetadata(e);Wr(d);let m=new g(t?.SRP_B,16),p=new g(t?.SALT,16),{deviceKey:l}=d,{deviceGroupKey:h}=d,E=await n.getPasswordAuthenticationKey({username:d.deviceKey,password:d.randomPassword,serverBValue:m,salt:p}),v=Zo(),T={USERNAME:t?.USERNAME??e,PASSWORD_CLAIM_SECRET_BLOCK:t?.SECRET_BLOCK,TIMESTAMP:v,PASSWORD_CLAIM_SIGNATURE:Qo({username:l,userPoolName:h,challengeParameters:t,dateNow:v,hkdf:E}),DEVICE_KEY:l},R=U({username:e,userPoolId:i,userPoolClientId:s}),j={ChallengeName:"DEVICE_PASSWORD_VERIFIER",ClientId:s,ChallengeResponses:T,Session:r,ClientMetadata:o,UserContextData:R};return q({endpointResolver:x({endpointOverride:a})})({region:C(i)},j)}async function Dt(e,t,o,r,n,i,s){let{userPoolId:a,userPoolClientId:c,userPoolEndpoint:d}=i,m=a?.split("_")[1]||"",p=new g(t?.SRP_B,16),l=new g(t?.SALT,16),h=t?.USER_ID_FOR_SRP;if(!h)throw new f({name:"EmptyUserIdForSRPException",message:"USER_ID_FOR_SRP was not found in challengeParameters"});let E=await n.getPasswordAuthenticationKey({username:h,password:e,serverBValue:p,salt:l}),v=Zo(),T={USERNAME:h,PASSWORD_CLAIM_SECRET_BLOCK:t?.SECRET_BLOCK,TIMESTAMP:v,PASSWORD_CLAIM_SIGNATURE:Qo({username:h,userPoolName:m,challengeParameters:t,dateNow:v,hkdf:E})},R=await s.getDeviceMetadata(h);R&&R.deviceKey&&(T.DEVICE_KEY=R.deviceKey);let j=U({username:h,userPoolId:a,userPoolClientId:c}),Ee={ChallengeName:"PASSWORD_VERIFIER",ChallengeResponses:T,ClientMetadata:o,Session:r,ClientId:c,UserContextData:j},pe=await q({endpointResolver:x({endpointOverride:d})})({region:C(a)},Ee);return pe.ChallengeName==="DEVICE_SRP_AUTH"?Ot({username:h,config:i,clientMetadata:o,session:pe.Session,tokenOrchestrator:s}):pe}async function _e(e,t,o,r){try{return await e(...t)}catch(n){if(n instanceof f&&n.name==="ResourceNotFoundException"&&n.message.includes("Device does not exist."))return await r.clearDeviceMetadata(o),e(...t);throw n}}function xe(e){let{dispatch:t}=de;t({type:"SET_USERNAME",value:e})}async function er({username:e,password:t,clientMetadata:o,config:r,tokenOrchestrator:n,authFlow:i,preferredChallenge:s}){let{userPoolId:a,userPoolClientId:c,userPoolEndpoint:d}=r,m=a?.split("_")[1]||"",p=await ke(m),l={USERNAME:e,SRP_A:p.A.toString(16)};i==="USER_AUTH"&&s&&(l.PREFERRED_CHALLENGE=s);let h=U({username:e,userPoolId:a,userPoolClientId:c}),E={AuthFlow:i,AuthParameters:l,ClientMetadata:o,ClientId:c,UserContextData:h},T=await Qe({endpointResolver:x({endpointOverride:d})})({region:C(a),userAgentValue:P(w.SignIn)},E),{ChallengeParameters:R,Session:j}=T,Ee=R?.USERNAME??e;return xe(Ee),T.ChallengeName==="PASSWORD_VERIFIER"?_e(Dt,[t,R,o,j,p,r,n],Ee,n):T}async function Ts({username:e,session:t,selectedChallenge:o,config:r,clientMetadata:n}){return q({endpointResolver:x({endpointOverride:r.userPoolEndpoint})})({region:C(r.userPoolId),userAgentValue:P(w.ConfirmSignIn)},{ChallengeName:"SELECT_CHALLENGE",ChallengeResponses:{USERNAME:e,ANSWER:o},ClientId:r.userPoolClientId,Session:t,ClientMetadata:n})}async function Rs(e,t,o,r,n){let{userPoolId:i,userPoolClientId:s,userPoolEndpoint:a}=r,c={ANSWER:"PASSWORD",USERNAME:e,PASSWORD:t},d=U({username:e,userPoolId:i,userPoolClientId:s}),p=await q({endpointResolver:x({endpointOverride:a})})({region:C(i),userAgentValue:P(w.ConfirmSignIn)},{ChallengeName:"SELECT_CHALLENGE",ChallengeResponses:c,ClientId:s,ClientMetadata:o,Session:n,UserContextData:d}),l=p.ChallengeParameters?.USERNAME??e;return xe(l),p}async function _s(e,t,o,r,n,i){let{userPoolId:s,userPoolClientId:a,userPoolEndpoint:c}=r,d=s.split("_")[1]||"",m=await ke(d),p={ANSWER:"PASSWORD_SRP",USERNAME:e,SRP_A:m.A.toString(16)},l=U({username:e,userPoolId:s,userPoolClientId:a}),E=await q({endpointResolver:x({endpointOverride:c})})({region:C(s),userAgentValue:P(w.ConfirmSignIn)},{ChallengeName:"SELECT_CHALLENGE",ChallengeResponses:p,ClientId:a,ClientMetadata:o,Session:n,UserContextData:l}),v=E.ChallengeParameters?.USERNAME??e;return xe(v),E.ChallengeName==="PASSWORD_VERIFIER"?_e(Dt,[t,E.ChallengeParameters,o,E.Session,m,r,i],v,i):E}var Xr="userAttributes.";function Fd(e){return"isSignedIn"in e&&"nextStep"in e}async function Ld({challengeResponse:e,clientMetadata:t,session:o,username:r,config:n,tokenOrchestrator:i}){let{userPoolId:s,userPoolClientId:a,userPoolEndpoint:c}=n,d={USERNAME:r,ANSWER:e},m=await i?.getDeviceMetadata(r);m&&m.deviceKey&&(d.DEVICE_KEY=m.deviceKey);let p=U({username:r,userPoolId:s,userPoolClientId:a}),l={ChallengeName:"CUSTOM_CHALLENGE",ChallengeResponses:d,Session:o,ClientMetadata:t,ClientId:a,UserContextData:p},E=await q({endpointResolver:x({endpointOverride:c})})({region:C(s),userAgentValue:P(w.ConfirmSignIn)},l);return E.ChallengeName==="DEVICE_SRP_AUTH"?Ot({username:r,config:n,clientMetadata:t,session:E.Session,tokenOrchestrator:i}):E}async function Hd({challengeResponse:e,username:t,clientMetadata:o,session:r,deviceName:n,config:i}){let{userPoolId:s,userPoolClientId:a,userPoolEndpoint:c}=i;if(e==="EMAIL")return{ChallengeName:"MFA_SETUP",Session:r,ChallengeParameters:{MFAS_CAN_SETUP:'["EMAIL_OTP"]'},$metadata:{}};if(e==="TOTP")return{ChallengeName:"MFA_SETUP",Session:r,ChallengeParameters:{MFAS_CAN_SETUP:'["SOFTWARE_TOKEN_MFA"]'},$metadata:{}};let d={USERNAME:t};if(/^\d+$/.test(e)){let l=Xi({endpointResolver:x({endpointOverride:c})}),{Session:h}=await l({region:C(s),userAgentValue:P(w.ConfirmSignIn)},{UserCode:e,Session:r,FriendlyDeviceName:n});de.dispatch({type:"SET_SIGN_IN_SESSION",value:h});let E={ChallengeName:"MFA_SETUP",ChallengeResponses:d,Session:h,ClientMetadata:o,ClientId:a};return q({endpointResolver:x({endpointOverride:c})})({region:C(s),userAgentValue:P(w.ConfirmSignIn)},E)}if(e.includes("@")){d.EMAIL=e;let l={ChallengeName:"MFA_SETUP",ChallengeResponses:d,Session:r,ClientMetadata:o,ClientId:a};return q({endpointResolver:x({endpointOverride:c})})({region:C(s),userAgentValue:P(w.ConfirmSignIn)},l)}throw new f({name:he.SignInException,message:`Cannot proceed with MFA setup using challengeResponse: ${e}`,recoverySuggestion:'Try passing "EMAIL", "TOTP", a valid email, or OTP code as the challengeResponse.'})}async function Bd({challengeResponse:e,username:t,clientMetadata:o,session:r,config:n}){let{userPoolId:i,userPoolClientId:s,userPoolEndpoint:a}=n;_(e==="TOTP"||e==="SMS"||e==="EMAIL",y.IncorrectMFAMethod);let c={USERNAME:t,ANSWER:qd(e)},d=U({username:t,userPoolId:i,userPoolClientId:s}),m={ChallengeName:"SELECT_MFA_TYPE",ChallengeResponses:c,Session:r,ClientMetadata:o,ClientId:s,UserContextData:d};return q({endpointResolver:x({endpointOverride:a})})({region:C(i),userAgentValue:P(w.ConfirmSignIn)},m)}async function Wd({challengeResponse:e,clientMetadata:t,session:o,username:r,requiredAttributes:n,config:i}){let{userPoolId:s,userPoolClientId:a,userPoolEndpoint:c}=i,d=S(u({},zd(n)),{NEW_PASSWORD:e,USERNAME:r}),m=U({username:r,userPoolId:s,userPoolClientId:a}),p={ChallengeName:"NEW_PASSWORD_REQUIRED",ChallengeResponses:d,ClientMetadata:t,Session:o,ClientId:a,UserContextData:m};return q({endpointResolver:x({endpointOverride:c})})({region:C(s),userAgentValue:P(w.ConfirmSignIn)},p)}async function bs(e,t,o,r,n){let{userPoolClientId:i,userPoolId:s,userPoolEndpoint:a}=r,c={USERNAME:e,PASSWORD:t},d=await n.getDeviceMetadata(e);d&&d.deviceKey&&(c.DEVICE_KEY=d.deviceKey);let m=U({username:e,userPoolId:s,userPoolClientId:i}),p={AuthFlow:"USER_PASSWORD_AUTH",AuthParameters:c,ClientMetadata:o,ClientId:i,UserContextData:m},h=await Qe({endpointResolver:x({endpointOverride:a})})({region:C(s),userAgentValue:P(w.SignIn)},p),E=h.ChallengeParameters?.USERNAME??h.ChallengeParameters?.USER_ID_FOR_SRP??e;return xe(E),h.ChallengeName==="DEVICE_SRP_AUTH"?Ot({username:E,config:r,clientMetadata:o,session:h.Session,tokenOrchestrator:n}):h}async function Os(e,t,o,r,n){return er({username:e,password:t,clientMetadata:o,config:r,tokenOrchestrator:n,authFlow:"USER_SRP_AUTH"})}async function Ds(e,t,o,r){let{userPoolClientId:n,userPoolId:i,userPoolEndpoint:s}=o,a={USERNAME:e},c=await r.getDeviceMetadata(e);c&&c.deviceKey&&(a.DEVICE_KEY=c.deviceKey);let d=U({username:e,userPoolId:i,userPoolClientId:n}),m={AuthFlow:"CUSTOM_AUTH",AuthParameters:a,ClientMetadata:t,ClientId:n,UserContextData:d},l=await Qe({endpointResolver:x({endpointOverride:s})})({region:C(i),userAgentValue:P(w.SignIn)},m),h=l.ChallengeParameters?.USERNAME??e;return xe(h),l.ChallengeName==="DEVICE_SRP_AUTH"?Ot({username:h,config:o,clientMetadata:t,session:l.Session,tokenOrchestrator:r}):l}async function Ms(e,t,o,r,n){I(r);let{userPoolId:i,userPoolClientId:s,userPoolEndpoint:a}=r,c=i?.split("_")[1]||"",d=await ke(c),m={USERNAME:e,SRP_A:d.A.toString(16),CHALLENGE_NAME:"SRP_A"},p=U({username:e,userPoolId:i,userPoolClientId:s}),l={AuthFlow:"CUSTOM_AUTH",AuthParameters:m,ClientMetadata:o,ClientId:s,UserContextData:p},h=Qe({endpointResolver:x({endpointOverride:a})}),{ChallengeParameters:E,Session:v}=await h({region:C(i),userAgentValue:P(w.SignIn)},l),T=E?.USERNAME??e;return xe(T),_e(Dt,[t,E,o,v,d,r,n],T,n)}async function ge(e){let{challengeName:t,challengeParameters:o,availableChallenges:r}=e,n=A.getConfig().Auth?.Cognito;switch(I(n),t){case"CUSTOM_CHALLENGE":return{isSignedIn:!1,nextStep:{signInStep:"CONFIRM_SIGN_IN_WITH_CUSTOM_CHALLENGE",additionalInfo:o}};case"MFA_SETUP":{let{signInSession:i,username:s}=de.getState(),a=Ns(Us(o.MFAS_CAN_SETUP))||[],c=$d(a),d=c.includes("TOTP"),m=c.includes("EMAIL");if(d&&m)return{isSignedIn:!1,nextStep:{signInStep:"CONTINUE_SIGN_IN_WITH_MFA_SETUP_SELECTION",allowedMFATypes:c}};if(m)return{isSignedIn:!1,nextStep:{signInStep:"CONTINUE_SIGN_IN_WITH_EMAIL_SETUP"}};if(d){let p=Zi({endpointResolver:x({endpointOverride:n.userPoolEndpoint})}),{Session:l,SecretCode:h}=await p({region:C(n.userPoolId)},{Session:i});return de.dispatch({type:"SET_SIGN_IN_SESSION",value:l}),{isSignedIn:!1,nextStep:{signInStep:"CONTINUE_SIGN_IN_WITH_TOTP_SETUP",totpSetupDetails:Vd(h,s)}}}throw new f({name:he.SignInException,message:`Cannot initiate MFA setup from available types: ${a}`})}case"NEW_PASSWORD_REQUIRED":return{isSignedIn:!1,nextStep:{signInStep:"CONFIRM_SIGN_IN_WITH_NEW_PASSWORD_REQUIRED",missingAttributes:Kd(o.requiredAttributes)}};case"SELECT_MFA_TYPE":return{isSignedIn:!1,nextStep:{signInStep:"CONTINUE_SIGN_IN_WITH_MFA_SELECTION",allowedMFATypes:Ns(Us(o.MFAS_CAN_CHOOSE))}};case"SMS_OTP":case"SMS_MFA":return{isSignedIn:!1,nextStep:{signInStep:"CONFIRM_SIGN_IN_WITH_SMS_CODE",codeDeliveryDetails:{deliveryMedium:o.CODE_DELIVERY_DELIVERY_MEDIUM,destination:o.CODE_DELIVERY_DESTINATION}}};case"SOFTWARE_TOKEN_MFA":return{isSignedIn:!1,nextStep:{signInStep:"CONFIRM_SIGN_IN_WITH_TOTP_CODE"}};case"EMAIL_OTP":return{isSignedIn:!1,nextStep:{signInStep:"CONFIRM_SIGN_IN_WITH_EMAIL_CODE",codeDeliveryDetails:{deliveryMedium:o.CODE_DELIVERY_DELIVERY_MEDIUM,destination:o.CODE_DELIVERY_DESTINATION}}};case"WEB_AUTHN":{let i=await vs(o);return Fd(i)?i:ge(i)}case"PASSWORD":case"PASSWORD_SRP":return{isSignedIn:!1,nextStep:{signInStep:"CONFIRM_SIGN_IN_WITH_PASSWORD"}};case"SELECT_CHALLENGE":return{isSignedIn:!1,nextStep:{signInStep:"CONTINUE_SIGN_IN_WITH_FIRST_FACTOR_SELECTION",availableChallenges:r}}}throw new f({name:he.SignInException,message:`An error occurred during the sign in process. ${t} challengeName returned by the underlying service was not addressed.`})}function Vd(e,t){return{sharedSecret:e,getSetupUri:(o,r)=>{let n=`otpauth://totp/${o}:${r??t}?secret=${e}&issuer=${o}`;return new ne(n)}}}function we(e){if(e===ko.PasswordResetRequiredException)return{isSignedIn:!1,nextStep:{signInStep:"RESET_PASSWORD"}};if(e===ko.UserNotConfirmedException)return{isSignedIn:!1,nextStep:{signInStep:"CONFIRM_SIGN_UP"}}}function Kd(e){return e?JSON.parse(e).map(o=>o.includes(Xr)?o.replace(Xr,""):o):[]}function zd(e){if(!e)return{};let t={};return Object.entries(e).forEach(([o,r])=>{r&&(t[`${Xr}${o}`]=r)}),t}async function ks(e,t,o,r,n,i,s,a){let c=a?.userAttributes,d=a?.friendlyDeviceName;switch(t){case"WEB_AUTHN":case"SELECT_CHALLENGE":return r==="PASSWORD_SRP"||r==="PASSWORD"?{ChallengeName:r,Session:o,$metadata:{}}:Ts({username:e,session:o,selectedChallenge:r,config:n,clientMetadata:s});case"SELECT_MFA_TYPE":return Bd({challengeResponse:r,clientMetadata:s,session:o,username:e,config:n});case"MFA_SETUP":return Hd({challengeResponse:r,clientMetadata:s,session:o,username:e,deviceName:d,config:n});case"NEW_PASSWORD_REQUIRED":return Wd({challengeResponse:r,clientMetadata:s,session:o,username:e,requiredAttributes:c,config:n});case"CUSTOM_CHALLENGE":return _e(Ld,[{challengeResponse:r,clientMetadata:s,session:o,username:e,config:n,tokenOrchestrator:i}],e,i);case"SMS_MFA":case"SOFTWARE_TOKEN_MFA":case"SMS_OTP":case"EMAIL_OTP":return jd({challengeName:t,challengeResponse:r,clientMetadata:s,session:o,username:e,config:n});case"PASSWORD":return Rs(e,r,s,n,o);case"PASSWORD_SRP":return _s(e,r,s,n,o,i)}throw new f({name:he.SignInException,message:`An error occurred during the sign in process.
		${t} challengeName returned by the underlying service was not addressed.`})}function qd(e){let t="SMS_MFA";return e==="TOTP"&&(t="SOFTWARE_TOKEN_MFA"),e==="EMAIL"&&(t="EMAIL_OTP"),t}function Gd(e){if(e==="SMS_MFA")return"SMS";if(e==="SOFTWARE_TOKEN_MFA")return"TOTP";if(e==="EMAIL_OTP")return"EMAIL"}function Ns(e){if(e)return e.map(Gd).filter(Boolean)}function Us(e){return e?JSON.parse(e):[]}function $d(e){return e.filter(t=>t==="EMAIL"||t==="TOTP")}async function tr(){let e;try{e=await Ho()}catch{}if(e&&e.userId&&e.username)throw new f({name:Hi,message:"There is already a signed in user.",recoverySuggestion:"Call signOut before calling signIn again."})}function Fe(e){return de.getState().username??e}async function jd({challengeName:e,challengeResponse:t,clientMetadata:o,session:r,username:n,config:i}){let{userPoolId:s,userPoolClientId:a,userPoolEndpoint:c}=i,d={USERNAME:n};e==="EMAIL_OTP"&&(d.EMAIL_OTP_CODE=t),e==="SMS_MFA"&&(d.SMS_MFA_CODE=t),e==="SMS_OTP"&&(d.SMS_OTP_CODE=t),e==="SOFTWARE_TOKEN_MFA"&&(d.SOFTWARE_TOKEN_MFA_CODE=t);let m=U({username:n,userPoolId:s,userPoolClientId:a}),p={ChallengeName:e,ChallengeResponses:d,Session:r,ClientMetadata:o,ClientId:a,UserContextData:m};return q({endpointResolver:x({endpointOverride:c})})({region:C(s),userAgentValue:P(w.ConfirmSignIn)},p)}async function Fs(e){let t=A.getConfig().Auth?.Cognito;I(t);let{username:o,password:r,options:n}=e,i={loginId:o,authFlowType:"CUSTOM_WITHOUT_SRP"},s=n?.clientMetadata;_(!!o,y.EmptySignInUsername),_(!r,y.CustomAuthSignInPassword);try{let{ChallengeName:a,ChallengeParameters:c,AuthenticationResult:d,Session:m}=await _e(Ds,[o,s,t,L],o,L),p=Fe(o);return me({signInSession:m,username:p,challengeName:a,signInDetails:i}),d?(await ee(S(u({username:p},d),{NewDeviceMetadata:await ue({userPoolId:t.userPoolId,userPoolEndpoint:t.userPoolEndpoint,newDeviceMetadata:d.NewDeviceMetadata,accessToken:d.AccessToken}),signInDetails:i})),te(),await oe(),{isSignedIn:!0,nextStep:{signInStep:"DONE"}}):ge({challengeName:a,challengeParameters:c})}catch(a){te(),B(a);let c=we(a.name);if(c)return c;throw a}}async function Ls(e){let{username:t,password:o,options:r}=e,n={loginId:t,authFlowType:"CUSTOM_WITH_SRP"},i=A.getConfig().Auth?.Cognito;I(i);let s=r?.clientMetadata;_(!!t,y.EmptySignInUsername),_(!!o,y.EmptySignInPassword);try{let{ChallengeName:a,ChallengeParameters:c,AuthenticationResult:d,Session:m}=await Ms(t,o,s,i,L),p=Fe(t);return me({signInSession:m,username:p,challengeName:a,signInDetails:n}),d?(await ee(S(u({username:p},d),{NewDeviceMetadata:await ue({userPoolId:i.userPoolId,userPoolEndpoint:i.userPoolEndpoint,newDeviceMetadata:d.NewDeviceMetadata,accessToken:d.AccessToken}),signInDetails:n})),te(),await oe(),{isSignedIn:!0,nextStep:{signInStep:"DONE"}}):ge({challengeName:a,challengeParameters:c})}catch(a){te(),B(a);let c=we(a.name);if(c)return c;throw a}}var Hs=async()=>{throw new f({name:Fo,message:"The autoSignIn flow has not started, or has been cancelled/completed.",recoverySuggestion:"Please try to use the signIn API or log out before starting a new autoSignIn flow."})},Bs=Hs;function no(e){Bs=e}function $(e=!0){e&&(Bs=Hs),Ae.dispatch({type:"RESET"})}async function Zr(e){let{username:t,password:o}=e,r=A.getConfig().Auth?.Cognito,n={loginId:t,authFlowType:"USER_SRP_AUTH"};I(r);let i=e.options?.clientMetadata;_(!!t,y.EmptySignInUsername),_(!!o,y.EmptySignInPassword);try{let{ChallengeName:s,ChallengeParameters:a,AuthenticationResult:c,Session:d}=await Os(t,o,i,r,L),m=Fe(t);return me({signInSession:d,username:m,challengeName:s,signInDetails:n}),c?(await ee(S(u({username:m},c),{NewDeviceMetadata:await ue({userPoolId:r.userPoolId,userPoolEndpoint:r.userPoolEndpoint,newDeviceMetadata:c.NewDeviceMetadata,accessToken:c.AccessToken}),signInDetails:n})),te(),await oe(),$(),{isSignedIn:!0,nextStep:{signInStep:"DONE"}}):ge({challengeName:s,challengeParameters:a})}catch(s){te(),$(),B(s);let a=we(s.name);if(a)return a;throw s}}async function Ws(e){let{username:t,password:o,options:r}=e,n=A.getConfig().Auth?.Cognito,i={loginId:t,authFlowType:"USER_PASSWORD_AUTH"};I(n);let s=r?.clientMetadata;_(!!t,y.EmptySignInUsername),_(!!o,y.EmptySignInPassword);try{let{ChallengeName:a,ChallengeParameters:c,AuthenticationResult:d,Session:m}=await _e(bs,[t,o,s,n,L],t,L),p=Fe(t);return me({signInSession:m,username:p,challengeName:a,signInDetails:i}),d?(await ee(S(u({},d),{username:p,NewDeviceMetadata:await ue({userPoolId:n.userPoolId,userPoolEndpoint:n.userPoolEndpoint,newDeviceMetadata:d.NewDeviceMetadata,accessToken:d.AccessToken}),signInDetails:i})),te(),await oe(),$(),{isSignedIn:!0,nextStep:{signInStep:"DONE"}}):ge({challengeName:a,challengeParameters:c})}catch(a){te(),$(),B(a);let c=we(a.name);if(c)return c;throw a}}async function Vs({username:e,clientMetadata:t,config:o,tokenOrchestrator:r,preferredChallenge:n,password:i,session:s}){let{userPoolId:a,userPoolClientId:c,userPoolEndpoint:d}=o,m=U({username:e,userPoolId:a,userPoolClientId:c}),p={USERNAME:e};if(n){if(n==="PASSWORD_SRP")return _(!!i,y.EmptySignInPassword),er({username:e,password:i,clientMetadata:t,config:o,tokenOrchestrator:r,authFlow:"USER_AUTH",preferredChallenge:n});n==="PASSWORD"&&(_(!!i,y.EmptySignInPassword),p.PASSWORD=i),p.PREFERRED_CHALLENGE=n}let l={AuthFlow:"USER_AUTH",AuthParameters:p,ClientMetadata:t,ClientId:c,UserContextData:m};s&&(l.Session=s);let E=await Qe({endpointResolver:x({endpointOverride:d})})({region:C(a),userAgentValue:P(w.SignIn)},l);return xe(e),E}async function or(e){let{username:t,password:o,options:r}=e,n=A.getConfig().Auth?.Cognito,i={loginId:t,authFlowType:"USER_AUTH"};I(n);let s=r?.clientMetadata,a=r?.preferredChallenge;_(!!t,y.EmptySignInUsername);try{let c={username:t,config:n,tokenOrchestrator:L,clientMetadata:s,preferredChallenge:a,password:o},d=Ae.getState();d.active&&d.username===t&&(c.session=d.session);let m=await Vs(c),p=Fe(t);return me({signInSession:m.Session,username:p,challengeName:m.ChallengeName,signInDetails:i}),m.AuthenticationResult?(await ee(S(u({username:p},m.AuthenticationResult),{NewDeviceMetadata:await ue({userPoolId:n.userPoolId,userPoolEndpoint:n.userPoolEndpoint,newDeviceMetadata:m.AuthenticationResult.NewDeviceMetadata,accessToken:m.AuthenticationResult.AccessToken}),signInDetails:i})),te(),await oe(),$(),{isSignedIn:!0,nextStep:{signInStep:"DONE"}}):ge({challengeName:m.ChallengeName,challengeParameters:m.ChallengeParameters,availableChallenges:"AvailableChallenges"in m?m.AvailableChallenges:void 0})}catch(c){te(),$(),B(c);let d=we(c.name);if(d)return d;throw c}}async function gt(e){$(!1);let t=e.options?.authFlowType;switch(await tr(),t){case"USER_SRP_AUTH":return Zr(e);case"USER_PASSWORD_AUTH":return Ws(e);case"CUSTOM_WITHOUT_SRP":return Fs(e);case"CUSTOM_WITH_SRP":return Ls(e);case"USER_AUTH":return or(e);default:return Zr(e)}}var Ks=180*1e3;function zs(e){let t=it.listen("auth-internal",async({payload:r})=>{switch(r.event){case"confirmSignUp":r.data?.isSignUpComplete&&(it.dispatch("auth-internal",{event:"autoSignIn"}),no($s(e)),t())}}),o=setTimeout(()=>{t(),clearTimeout(o),$()},Ks)}function qs(e,t){let o;return r=>{o||e(...r),clearTimeout(o),o=setTimeout(()=>{o=void 0},t)}}function Yd(e,t,o){let r=Date.now(),n=setInterval(async()=>{if(Date.now()-r>Ks)clearInterval(n),o(new f({name:Fo,message:"The account was not confirmed on time.",recoverySuggestion:"Try to verify your account by clicking the link sent your email or phone and then login manually."})),$();else try{let a=await gt(e);a.nextStep.signInStep!=="CONFIRM_SIGN_UP"&&(t(a),clearInterval(n),$())}catch(a){clearInterval(n),o(a),$()}},5e3)}var Jd=qs(Yd,300),Xd=qs(Zd,300);function Gs(e){return async()=>new Promise((t,o)=>{Jd([e,t,o])})}async function Zd(e,t,o){try{let r=e?.options?.authFlowType==="USER_AUTH"?await or(e):await gt(e);t(r),$()}catch(r){o(r),$()}}function $s(e){return async()=>new Promise((t,o)=>{Xd([e,t,o])})}var js=$s;var Qd=()=>async e=>{if(e.statusCode>=300){let t=await fe(e);if(B(t),t.name===Br.InvalidParameterException&&/'password'/.test(t.message)&&/Member must not be null/.test(t.message)){let o=y.EmptySignUpPassword,{message:r,recoverySuggestion:n}=Mo[o];throw new f({name:o,message:r,recoverySuggestion:n})}throw new f({name:t.name,message:t.message})}return Ue(e)},Ys=e=>N(O,b("SignUp"),Qd(),u(u({},D),e));async function Qr(e){let{username:t,password:o,options:r}=e,n=A.getConfig().Auth?.Cognito,i=n?.signUpVerificationMethod??"code",{clientMetadata:s,validationData:a,autoSignIn:c}=e.options??{};I(n),_(!!t,y.EmptySignUpUsername);let d=typeof c!="boolean"?c:void 0,m={username:t,options:d};d?.authFlowType!=="CUSTOM_WITHOUT_SRP"&&(m.password=o);let{userPoolId:p,userPoolClientId:l,userPoolEndpoint:h}=n,E=Ys({endpointResolver:x({endpointOverride:h})}),v={Username:t,Password:void 0,UserAttributes:r?.userAttributes&&Hr(r?.userAttributes),ClientMetadata:s,ValidationData:a&&Hr(a),ClientId:l,UserContextData:U({username:t,userPoolId:p,userPoolClientId:l})};o&&(v.Password=o);let{UserSub:T,CodeDeliveryDetails:R,UserConfirmed:j,Session:Ee}=await E({region:C(p),userAgentValue:P(w.SignUp)},v);(d||c===!0)&&(Ae.dispatch({type:"START"}),Ae.dispatch({type:"SET_USERNAME",value:t}),Ae.dispatch({type:"SET_SESSION",value:Ee}));let $e={destination:R?.Destination,deliveryMedium:R?.DeliveryMedium,attributeName:R?.AttributeName},pe=!!j,re=Ae.getState().active;if(pe)return re?(no(js(m)),{isSignUpComplete:!0,nextStep:{signUpStep:"COMPLETE_AUTO_SIGN_IN"},userId:T}):{isSignUpComplete:!0,nextStep:{signUpStep:"DONE"},userId:T};if(re){if(i==="link")return no(Gs(m)),{isSignUpComplete:!1,nextStep:{signUpStep:"COMPLETE_AUTO_SIGN_IN",codeDeliveryDetails:$e},userId:T};zs(m)}return{isSignUpComplete:!1,nextStep:{signUpStep:"CONFIRM_SIGN_UP",codeDeliveryDetails:$e},userId:T}}var Js=e=>N(O,b("ForgotPassword"),k(),u(u({},D),e));async function en(e){let{username:t}=e;_(!!t,y.EmptyResetPasswordUsername);let o=A.getConfig().Auth?.Cognito;I(o);let{userPoolClientId:r,userPoolId:n,userPoolEndpoint:i}=o,s=e.options?.clientMetadata,a=U({username:t,userPoolId:n,userPoolClientId:r}),m=(await Js({endpointResolver:x({endpointOverride:i})})({region:C(n),userAgentValue:P(w.ResetPassword)},{Username:t,ClientMetadata:s,ClientId:r,UserContextData:a})).CodeDeliveryDetails;return{isPasswordReset:!1,nextStep:{resetPasswordStep:"CONFIRM_RESET_PASSWORD_WITH_CODE",codeDeliveryDetails:{deliveryMedium:m?.DeliveryMedium,destination:m?.Destination,attributeName:m?.AttributeName}}}}var Xs=e=>N(O,b("ConfirmForgotPassword"),k(),u(u({},D),e));async function tn(e){let t=A.getConfig().Auth?.Cognito;I(t);let{userPoolClientId:o,userPoolId:r,userPoolEndpoint:n}=t,{username:i,newPassword:s}=e;_(!!i,y.EmptyConfirmResetPasswordUsername),_(!!s,y.EmptyConfirmResetPasswordNewPassword);let a=e.confirmationCode;_(!!a,y.EmptyConfirmResetPasswordConfirmationCode);let c=e.options?.clientMetadata,d=U({username:i,userPoolId:r,userPoolClientId:o});await Xs({endpointResolver:x({endpointOverride:n})})({region:C(t.userPoolId),userAgentValue:P(w.ConfirmResetPassword)},{Username:i,ConfirmationCode:a,Password:s,ClientMetadata:c,ClientId:t.userPoolClientId,UserContextData:d})}var Zs=e=>N(O,b("ResendConfirmationCode"),k(),u(u({},D),e));async function on(e){let{username:t}=e;_(!!t,y.EmptySignUpUsername);let o=A.getConfig().Auth?.Cognito;I(o);let{userPoolClientId:r,userPoolId:n,userPoolEndpoint:i}=o,s=e.options?.clientMetadata,a=U({username:t,userPoolId:n,userPoolClientId:r}),c=Zs({endpointResolver:x({endpointOverride:i})}),{CodeDeliveryDetails:d}=await c({region:C(o.userPoolId),userAgentValue:P(w.ResendSignUpCode)},{Username:t,ClientMetadata:s,ClientId:o.userPoolClientId,UserContextData:a}),{DeliveryMedium:m,AttributeName:p,Destination:l}=u({},d);return{destination:l,deliveryMedium:m,attributeName:p||void 0}}var Qs=e=>N(O,b("ConfirmSignUp"),k(),u(u({},D),e));async function rn(e){let{username:t,confirmationCode:o,options:r}=e,n=A.getConfig().Auth?.Cognito;I(n);let{userPoolId:i,userPoolClientId:s,userPoolEndpoint:a}=n,c=r?.clientMetadata;_(!!t,y.EmptyConfirmSignUpUsername),_(!!o,y.EmptyConfirmSignUpCode);let d=U({username:t,userPoolId:i,userPoolClientId:s}),m=Qs({endpointResolver:x({endpointOverride:a})}),{Session:p}=await m({region:C(n.userPoolId),userAgentValue:P(w.ConfirmSignUp)},{Username:t,ConfirmationCode:o,ClientMetadata:c,ForceAliasCreation:r?.forceAliasCreation,ClientId:n.userPoolClientId,UserContextData:d});return new Promise((l,h)=>{try{let E={isSignUpComplete:!0,nextStep:{signUpStep:"DONE"}},v=Ae.getState();if(!v.active||v.username!==t){l(E),$();return}Ae.dispatch({type:"SET_SESSION",value:p});let T=it.listen("auth-internal",({payload:R})=>{switch(R.event){case"autoSignIn":l({isSignUpComplete:!0,nextStep:{signUpStep:"COMPLETE_AUTO_SIGN_IN"}}),T()}});it.dispatch("auth-internal",{event:"confirmSignUp",data:E})}catch(E){h(E)}})}async function nn(e){let{challengeResponse:t,options:o}=e,{username:r,challengeName:n,signInSession:i,signInDetails:s}=de.getState(),a=A.getConfig().Auth?.Cognito;I(a);let c=o?.clientMetadata;if(_(!!t,y.EmptyChallengeResponse),!r||!n||!i)throw new f({name:he.SignInException,message:`
			An error occurred during the sign in process.

			This most likely occurred due to:
			1. signIn was not called before confirmSignIn.
			2. signIn threw an exception.
			3. page was refreshed during the sign in flow and session has expired.
			`,recoverySuggestion:"Make sure a successful call to signIn is made before calling confirmSignInand that the session has not expired."});try{let{Session:d,ChallengeName:m,AuthenticationResult:p,ChallengeParameters:l}=await ks(r,n,i,t,a,L,c,o);return me({signInSession:d,username:r,challengeName:m,signInDetails:s}),p?(await ee(S(u({username:r},p),{NewDeviceMetadata:await ue({userPoolId:a.userPoolId,userPoolEndpoint:a.userPoolEndpoint,newDeviceMetadata:p.NewDeviceMetadata,accessToken:p.AccessToken}),signInDetails:s})),te(),await oe(),{isSignedIn:!0,nextStep:{signInStep:"DONE"}}):ge({challengeName:m,challengeParameters:l})}catch(d){B(d);let m=we(d.name);if(m)return m;throw d}}var ea=e=>N(O,b("GetUser"),k(),u(u({},D),e));var xT=new M("AuthError");var ta={oauthSignInError:{message:J.OAUTH_ERROR,log:"Make sure Cognito Hosted UI has been configured correctly"},noConfig:{message:J.DEFAULT_MSG,log:`
            Error: Amplify has not been configured correctly.
            This error is typically caused by one of the following scenarios:

            1. Make sure you're passing the awsconfig object to Amplify.configure() in your app's entry point
                See https://aws-amplify.github.io/docs/js/authentication#configure-your-app for more information
            
            2. There might be multiple conflicting versions of amplify packages in your node_modules.
				Refer to our docs site for help upgrading Amplify packages (https://docs.amplify.aws/lib/troubleshooting/upgrading/q/platform/js)
        `},missingAuthConfig:{message:J.DEFAULT_MSG,log:`
            Error: Amplify has not been configured correctly. 
            The configuration object is missing required auth properties.
            This error is typically caused by one of the following scenarios:

            1. Did you run \`amplify push\` after adding auth via \`amplify add auth\`?
                See https://aws-amplify.github.io/docs/js/authentication#amplify-project-setup for more information

            2. This could also be caused by multiple conflicting versions of amplify packages, see (https://docs.amplify.aws/lib/troubleshooting/upgrading/q/platform/js) for help upgrading Amplify packages.
        `},emptyUsername:{message:J.EMPTY_USERNAME},invalidUsername:{message:J.INVALID_USERNAME},emptyPassword:{message:J.EMPTY_PASSWORD},emptyCode:{message:J.EMPTY_CODE},signUpError:{message:J.SIGN_UP_ERROR,log:"The first parameter should either be non-null string or object"},noMFA:{message:J.NO_MFA},invalidMFA:{message:J.INVALID_MFA},emptyChallengeResponse:{message:J.EMPTY_CHALLENGE},noUserSession:{message:J.NO_USER_SESSION},deviceConfig:{message:J.DEVICE_CONFIG},networkError:{message:J.NETWORK_ERROR},autoSignInError:{message:J.AUTOSIGNIN_ERROR},default:{message:J.DEFAULT_MSG}};var Le=(e,t)=>new f({message:e??"An error has occurred during the oauth process.",name:he.OAuthSignInError,recoverySuggestion:t??ta.oauthSignInError.log});var sn=(function(e){return e.NoConfig="noConfig",e.MissingAuthConfig="missingAuthConfig",e.EmptyUsername="emptyUsername",e.InvalidUsername="invalidUsername",e.EmptyPassword="emptyPassword",e.EmptyCode="emptyCode",e.SignUpError="signUpError",e.NoMFA="noMFA",e.InvalidMFA="invalidMFA",e.EmptyChallengeResponse="emptyChallengeResponse",e.NoUserSession="noUserSession",e.Default="default",e.DeviceConfig="deviceConfig",e.NetworkError="networkError",e.AutoSignInError="autoSignInError",e.OAuthSignInError="oauthSignInError",e})(sn||{});var em="`signInWithRedirect` has been canceled.",tm="An error occurred while validating the state.",om="Try to initiate an OAuth flow from Amplify",an=async e=>{let t=await G.loadOAuthState(),o=e===t?t:void 0;if(!o)throw new f({name:sn.OAuthSignInError,message:e===null?em:tm,recoverySuggestion:e===null?void 0:om});return o};var rr=async({currentUrl:e,userAgentValue:t,clientId:o,redirectUri:r,responseType:n,domain:i,preferPrivateSession:s})=>{let a=new ne(e),c=a.searchParams.get("error"),d=a.searchParams.get("error_description");if(c)throw Le(d??c);return n==="code"?rm({currentUrl:e,userAgentValue:t,clientId:o,redirectUri:r,domain:i,preferPrivateSession:s}):nm({currentUrl:e,redirectUri:r,preferPrivateSession:s})},rm=async({currentUrl:e,userAgentValue:t,clientId:o,redirectUri:r,domain:n,preferPrivateSession:i})=>{let s=new ne(e),a=s.searchParams.get("code"),c=s.searchParams.get("state");if(!a||!c)throw Le("User cancelled OAuth flow.");let d=await an(c),m="https://"+n+"/oauth2/token",p=await G.loadPKCE(),l=u({grant_type:"authorization_code",code:a,client_id:o,redirect_uri:r},p?{code_verifier:p}:{}),h=Object.entries(l).map(([re,ot])=>`${encodeURIComponent(re)}=${encodeURIComponent(ot)}`).join("&"),{access_token:E,refresh_token:v,id_token:T,error:R,error_message:j,token_type:Ee,expires_in:$e}=await(await fetch(m,{method:"POST",headers:{"Content-Type":"application/x-www-form-urlencoded",[gr]:t},body:h})).json();if(R)throw Le(j??R);let pe=(E&&Z(E).payload.username)??"username";return await ee({username:pe,AccessToken:E,IdToken:T,RefreshToken:v}),oa({redirectUri:r,state:d,preferPrivateSession:i})},nm=async({currentUrl:e,redirectUri:t,preferPrivateSession:o})=>{let r=new ne(e),{id_token:n,access_token:i,state:s,token_type:a,expires_in:c,error_description:d,error:m}=(r.hash??"#").substring(1).split("&").map(h=>h.split("=")).reduce((h,[E,v])=>S(u({},h),{[E]:v}),{id_token:void 0,access_token:void 0,state:void 0,token_type:void 0,expires_in:void 0,error_description:void 0,error:void 0});if(m)throw Le(d??m);if(!i)throw Le("No access token returned from OAuth flow.");let p=await an(s),l=(i&&Z(i).payload.username)??"username";return await ee({username:l,AccessToken:i,IdToken:n}),oa({redirectUri:t,state:p,preferPrivateSession:o})},oa=async({redirectUri:e,state:t,preferPrivateSession:o})=>{await L.setOAuthMetadata({oauthSignIn:!0}),await G.clearOAuthData(),await G.storeOAuthSignIn(!0,o),Ko(),am(e),im(t)&&z.dispatch("auth",{event:"customOAuthState",data:Mr(sm(t))},"Auth",Y),z.dispatch("auth",{event:"signInWithRedirect"},"Auth",Y),await oe()},im=e=>/-/.test(e),sm=e=>e.split("-").splice(1).join("-"),am=e=>{typeof window<"u"&&typeof window.history<"u"&&window.history.replaceState(window.history.state,"",e)};function Mt(e,t){if(t){let o=e?.find(r=>r===t);if(!o)throw Vi;return o}else{let o=e?.find(cm)??e?.find(dm),r=e?.find(um)??e?.find(mm);if(o)return o;throw r?Ki:Wi}}var cm=e=>e.startsWith(String(window.location.origin+(window.location.pathname||"/"))),dm=e=>e.includes(String(window.location.hostname)),mm=e=>e.startsWith("http://"),um=e=>e.startsWith("https://");var kt=async e=>{Ko(),await G.clearOAuthInflightData(),z.dispatch("auth",{event:"signInWithRedirect_failure",data:{error:e}},"Auth",Y)};var ra=async e=>{try{I(e),Be(e),G.setAuthConfig(e)}catch{return}if(await G.loadOAuthInFlight())try{let t=window.location.href,{loginWith:o,userPoolClientId:r}=e,{domain:n,redirectSignIn:i,responseType:s}=o.oauth,a=Mt(i);await rr({currentUrl:t,clientId:r,domain:n,redirectUri:a,responseType:s,userAgentValue:P(w.SignInWithRedirect)})}catch(t){await kt(t)}};Ke()&&A[Bt](ra);var na={Google:"Google",Facebook:"Facebook",Amazon:"LoginWithAmazon",Apple:"SignInWithApple"};var nr=async e=>{window?.location&&(window.location.href=e.replace("http://","https://"))};var ia="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",sa=e=>{let t=new Uint8Array(e);st().getRandomValues(t);let o="",r;for(let n of t)o+=ia.charAt(n%ia.length);return{value:o,method:"S256",toCodeChallenge(){return r||(r=pm(o),r)}}};function pm(e){let t=new We;return t.update(e),lm(ye.convert(t.digestSync(),{urlSafe:!0}))}function lm(e){return e.replace(/=/g,"")}var aa=()=>Dr(32);var ca=e=>{async function t(o){if(o.persisted&&await e.loadOAuthInFlight()){let n=Le("User cancelled OAuth flow.");await kt(n)}window.removeEventListener("pageshow",t)}window.addEventListener("pageshow",t)};async function ir(e){let t=A.getConfig().Auth?.Cognito;I(t),Be(t),G.setAuthConfig(t),e?.options?.prompt||await tr();let o="COGNITO";return typeof e?.provider=="string"?o=na[e.provider]:e?.provider?.custom&&(o=e.provider.custom),fm({oauthConfig:t.loginWith.oauth,clientId:t.userPoolClientId,provider:o,customState:e?.customState,preferPrivateSession:e?.options?.preferPrivateSession,options:{loginHint:e?.options?.loginHint,lang:e?.options?.lang,nonce:e?.options?.nonce,prompt:e?.options?.prompt},authSessionOpener:e?.options?.authSessionOpener})}var fm=async({oauthConfig:e,provider:t,clientId:o,customState:r,preferPrivateSession:n,options:i,authSessionOpener:s})=>{let{domain:a,redirectSignIn:c,responseType:d,scopes:m}=e,{loginHint:p,lang:l,nonce:h,prompt:E}=i??{},v=aa(),T=s||nr,R=r?`${v}-${kr(r)}`:v,{value:j,method:Ee,toCodeChallenge:$e}=sa(128),pe=Mt(e.redirectSignIn);Ke()&&G.storeOAuthInFlight(!0),G.storeOAuthState(R),G.storePKCE(j);let re=new URLSearchParams([["redirect_uri",pe],["response_type",d],["client_id",o],["identity_provider",t],["scope",m.join(" ")]]);p&&re.append("login_hint",p),l&&re.append("lang",l),h&&re.append("nonce",h),E&&re.append("prompt",E.toLowerCase()),re.append("state",R),d==="code"&&(re.append("code_challenge",$e()),re.append("code_challenge_method",Ee));let ot=new URL("/oauth2/authorize",`https://${a}/`);ot.search=re.toString(),ca(G);let{type:It,error:je,url:Lt}=await T(ot.href,c,n)??{};try{if(It==="error")throw Le(String(je));It==="success"&&Lt&&await rr({currentUrl:Lt,clientId:o,domain:a,redirectUri:pe,responseType:d,userAgentValue:P(w.SignInWithRedirect),preferPrivateSession:n})}catch(so){throw await kt(so),so}};var da=async e=>{let t=e.getConfig().Auth?.Cognito;I(t);let{userPoolEndpoint:o,userPoolId:r}=t,{tokens:n}=await zt(e,{forceRefresh:!1});xt(n);let i=ea({endpointResolver:x({endpointOverride:o})}),{UserAttributes:s}=await i({region:C(r),userAgentValue:P(w.FetchUserAttributes)},{AccessToken:n.accessToken.toString()});return Li(s)};var cn=()=>da(A);var ma=async e=>{await e.clearOAuthData(),L.clearTokens(),await Gt(),z.dispatch("auth",{event:"signedOut"},"Auth",Y)};var ua=async(e,t=!1,o)=>{Be(e);let{loginWith:r,userPoolClientId:n}=e,{domain:i,redirectSignOut:s}=r.oauth,a=Mt(s,o),c=`https://${i}/logout?${Object.entries({client_id:n,logout_uri:encodeURIComponent(a)}).map(([d,m])=>`${d}=${m}`).join("&")}`;return nr(c)};var pa=async(e,t,o,r)=>{let{isOAuthSignIn:n}=await t.loadOAuthSignIn(),i=await o.getOAuthMetadata();if(await ma(t),n||i?.oauthSignIn)return ua(e,!1,r)};var la=e=>N(O,b("RevokeToken"),k(),u(u({},D),e));var fa=e=>N(O,b("GlobalSignOut"),k(),u(u({},D),e));var ha=new M("Auth");async function dn(e){let t=A.getConfig().Auth?.Cognito;I(t),e?.global?await gm(t):await hm(t);let o;try{Be(t),o=!0}catch{o=!1}if(o){let r=new wt(Ie);r.setAuthConfig(t);let{type:n}=await pa(t,r,L,e?.oauth?.redirectUrl)??{};if(n==="error")throw new f({name:zi,message:"An error occurred when attempting to log out from OAuth provider."})}else L.clearTokens(),await Gt(),z.dispatch("auth",{event:"signedOut"},"Auth",Y)}async function hm(e){try{let{userPoolEndpoint:t,userPoolId:o,userPoolClientId:r}=e,n=await L.getTokenStore().loadTokens();Lo(n),Em(n.accessToken)&&await la({endpointResolver:x({endpointOverride:t})})({region:C(o),userAgentValue:P(w.SignOut)},{ClientId:r,Token:n.refreshToken})}catch{ha.debug("Client signOut error caught but will proceed with token removal")}}async function gm(e){try{let{userPoolEndpoint:t,userPoolId:o}=e,r=await L.getTokenStore().loadTokens();xt(r),await fa({endpointResolver:x({endpointOverride:t})})({region:C(o),userAgentValue:P(w.SignOut)},{AccessToken:r.accessToken.toString()})}catch{ha.debug("Global signOut error caught but will proceed with token removal")}}var Em=e=>!!e?.payload?.origin_jti;var ga={identityId:"identityId"};var Sm=new M("DefaultIdentityIdStore"),Et=class{setAuthConfig(t){ct(t.Cognito),this.authConfig=t,this._authKeys=Im("Cognito",t.Cognito.identityPoolId)}constructor(t){this._authKeys={},this._hasGuestIdentityId=!1,this.keyValueStorage=t}async loadIdentityId(){ct(this.authConfig?.Cognito);try{if(this._primaryIdentityId)return{id:this._primaryIdentityId,type:"primary"};{let t=await this.keyValueStorage.getItem(this._authKeys.identityId);return t?(this._hasGuestIdentityId=!0,{id:t,type:"guest"}):null}}catch(t){return Sm.log("Error getting stored IdentityId.",t),null}}async storeIdentityId(t){ct(this.authConfig?.Cognito),t.type==="guest"?(this.keyValueStorage.setItem(this._authKeys.identityId,t.id),this._primaryIdentityId=void 0,this._hasGuestIdentityId=!0):(this._primaryIdentityId=t.id,this._hasGuestIdentityId&&(this.keyValueStorage.removeItem(this._authKeys.identityId),this._hasGuestIdentityId=!1))}async clearIdentityId(){this._primaryIdentityId=void 0,await this.keyValueStorage.removeItem(this._authKeys.identityId)}},Im=(e,t)=>oo(ga)(`com.amplify.${e}`,t);var io=({endpointOverride:e})=>t=>e?{url:new ne(e)}:Nr(t);function sr(e){let t=Z(e).payload.iss,o={};if(!t)throw new f({name:"InvalidIdTokenException",message:"Invalid Idtoken."});let r=t.replace(/(^\w+:|^)\/\//,"");return o[r]=e,o}async function Ea({tokens:e,authConfig:t,identityIdStore:o}){o.setAuthConfig({Cognito:t});let r=await o.loadIdentityId();if(r)return r.id;let n=e?.idToken?sr(e.idToken.toString()):{},i=await ym(n,t);return o.storeIdentityId({id:i,type:e?"primary":"guest"}),i}async function ym(e,t){let o=t?.identityPoolId,r=to(o),n=Rr({endpointResolver:io({endpointOverride:t.identityPoolEndpoint})}),i;try{i=(await n({region:r},{IdentityPoolId:o,Logins:e})).IdentityId}catch(s){throw B(s),new f(s)}if(!i)throw new f({name:"GetIdResponseException",message:"Received undefined response from getId operation",recoverySuggestion:"Make sure to pass a valid identityPoolId in the configuration."});return i}var ar=new M("CognitoCredentialsProvider"),Sa=3e3*1e3,St=class{constructor(t){this._nextCredentialsRefresh=0,this._identityIdStore=t}async clearCredentialsAndIdentityId(){ar.debug("Clearing out credentials and identityId"),this._credentialsAndIdentityId=void 0,await this._identityIdStore.clearIdentityId()}async clearCredentials(){ar.debug("Clearing out in-memory credentials"),this._credentialsAndIdentityId=void 0}async getCredentialsAndIdentityId(t){let o=t.authenticated,{tokens:r}=t,{authConfig:n}=t;try{ct(n?.Cognito)}catch{return}if(!o&&!n.Cognito.allowGuestAccess)return;let{forceRefresh:i}=t,s=this.hasTokenChanged(r),a=await Ea({tokens:r,authConfig:n.Cognito,identityIdStore:this._identityIdStore});return(i||s)&&this.clearCredentials(),o?($i(r),this.credsForOIDCTokens(n.Cognito,r,a)):this.getGuestCredentials(a,n.Cognito)}async getGuestCredentials(t,o){if(this._credentialsAndIdentityId&&!this.isPastTTL()&&this._credentialsAndIdentityId.isAuthenticatedCreds===!1)return ar.info("returning stored credentials as they neither past TTL nor expired."),this._credentialsAndIdentityId;this.clearCredentials();let r=to(o.identityPoolId),n=xo({endpointResolver:io({endpointOverride:o.identityPoolEndpoint})}),i;try{i=await n({region:r},{IdentityId:t})}catch(s){throw B(s),new f(s)}if(i?.Credentials?.AccessKeyId&&i?.Credentials?.SecretKey){this._nextCredentialsRefresh=new Date().getTime()+Sa;let s={credentials:{accessKeyId:i.Credentials.AccessKeyId,secretAccessKey:i.Credentials.SecretKey,sessionToken:i.Credentials.SessionToken,expiration:i.Credentials.Expiration},identityId:t};return i.IdentityId&&(s.identityId=i.IdentityId,this._identityIdStore.storeIdentityId({id:i.IdentityId,type:"guest"})),this._credentialsAndIdentityId=S(u({},s),{isAuthenticatedCreds:!1}),s}else throw new f({name:"CredentialsNotFoundException",message:"Cognito did not respond with either Credentials, AccessKeyId or SecretKey."})}async credsForOIDCTokens(t,o,r){if(this._credentialsAndIdentityId&&!this.isPastTTL()&&this._credentialsAndIdentityId.isAuthenticatedCreds===!0)return ar.debug("returning stored credentials as they neither past TTL nor expired."),this._credentialsAndIdentityId;this.clearCredentials();let n=o.idToken?sr(o.idToken.toString()):{},i=to(t.identityPoolId),s=xo({endpointResolver:io({endpointOverride:t.identityPoolEndpoint})}),a;try{a=await s({region:i},{IdentityId:r,Logins:n})}catch(c){throw B(c),new f(c)}if(a?.Credentials?.AccessKeyId&&a?.Credentials?.SecretKey){this._nextCredentialsRefresh=new Date().getTime()+Sa;let c={credentials:{accessKeyId:a.Credentials.AccessKeyId,secretAccessKey:a.Credentials.SecretKey,sessionToken:a.Credentials.SessionToken,expiration:a.Credentials.Expiration},identityId:r};return a.IdentityId&&(c.identityId=a.IdentityId,this._identityIdStore.storeIdentityId({id:a.IdentityId,type:"primary"})),this._credentialsAndIdentityId=S(u({},c),{isAuthenticatedCreds:!0,associatedIdToken:o.idToken?.toString()}),c}else throw new f({name:"CredentialsException",message:"Cognito did not respond with either Credentials, AccessKeyId or SecretKey."})}isPastTTL(){return this._nextCredentialsRefresh===void 0?!0:this._nextCredentialsRefresh<=Date.now()}hasTokenChanged(t){return!!t&&!!this._credentialsAndIdentityId?.associatedIdToken&&t.idToken?.toString()!==this._credentialsAndIdentityId.associatedIdToken}};var mn=new St(new Et(Ie));var cr={configure(e,t){let o=Wt(e),r=new At({sameSite:"lax"}),n=t?.ssr?r:Ie,i=t?.ssr?new St(new Et(r)):mn;if(!o.Auth){A.configure(o,t);return}if(t?.Auth){A.configure(o,t);return}if(!A.libraryOptions.Auth){ht.setAuthConfig(o.Auth),ht.setKeyValueStorage(n),A.configure(o,S(u({},t),{Auth:{tokenProvider:ht,credentialsProvider:i}}));return}if(t){let s=A.libraryOptions.Auth;t.ssr!==void 0&&(ht.setKeyValueStorage(n),s.credentialsProvider=i),A.configure(o,u({Auth:s},t));return}A.configure(o)},getConfig(){return A.getConfig()}};var Ft=class e{state;user;tokens;error;constructor(t,o,r,n){this.state=t,this.user=o,this.tokens=r,this.error=n}static fromError(t){return new e("error",void 0,void 0,t)}static fromAuthenticated(t,o){return new e("authenticated",t,o)}static unknown(){return new e("unknown")}static fromUnauthenticated(){return new e("unauthenticated")}},Ia=new An("AUTH_COGNITO_CONFIG"),XN=e=>{let t=e.cognito.oauth,o=[{provide:Ia,useValue:e}];return t?cr.configure({Auth:{Cognito:{userPoolId:e.cognito.userPoolId,userPoolClientId:e.cognito.userPoolClientId,loginWith:{oauth:u({scopes:["email","openid","aws.cognito.signin.user.admin"],responseType:"code"},t)}}}}):cr.configure({Auth:{Cognito:{userPoolId:e.cognito.userPoolId,userPoolClientId:e.cognito.userPoolClientId}}}),o},Am=async e=>{let t=await qt({forceRefresh:e}),o=t?.tokens?.idToken,r=t?.tokens?.accessToken;return!o||!r?null:{idToken:new hr(o.toString(),o.payload),accessToken:new hr(r.toString(),r.payload)}},ZN=(()=>{class e extends Tn{connectorConfig={identityConfirmation:"code",resetPasswordConfirmation:"code"};#e=nt(Rn);#t=nt(_n);#c=nt(wn);#n=nt(Nn);#d=nt(Ia);#m=nt(Cn);#i;constructor(){super(),this.startListening()}#a=()=>{};startListening(){this.#a=z.listen("auth",({payload:o})=>{switch(this.#t.reset(),o.event){case"signInWithRedirect":this.#s(),this.stopListening();break;case"signInWithRedirect_failure":this.stopListening(),this.#o(this.#r("signInWithProvider",o.data.error));break;case"customOAuthState":this.stopListening(),this.#o(new se("signInWithProvider","invalidConfiguration",new He("Custom OAuth state handling not implemented")));break}})}stopListening(){this.#a()}authState=xn({defaultValue:Ft.unknown(),loader:async()=>{try{if(!(await qt())?.tokens)return Ft.fromUnauthenticated();let r=await cn();if(!r)throw"Runtime error: user authenticated, but cannot be fetched";return Ft.fromAuthenticated({displayName:r.name??r.email??"",email:r.email,fullName:r.name,phone:r.phone_number,verified:!!r.email_verified},new Pn(Am))}catch(o){return Ft.fromError(new vn(o))}}});accessToken$=ao(this.authState.value).pipe(pr(void 0),ur(o=>o?.tokens||null),lr(async o=>o?.getAccessToken()??null));idToken$=ao(this.authState.value).pipe(pr(void 0),ur(o=>o?.tokens||null),lr(async o=>o?.getIdToken()??null));currentUser=fr(()=>this.authState.value().user);#u=ao(fr(()=>this.authState.value().state==="authenticated")).pipe(In(Boolean));async signOut(o=!1){try{this.#t.reset();let r=this.#m.defaultView;if(!r)throw new He("Window is not available. Cannot sign out.","Make sure to run this code in a browser environment.");let n=this.#d.cognito.oauth?.redirectSignOut??[],i=r.location.origin,s=[i,`${i}/`];if(this.#n.routing?.guest){let c=`${i}/${this.#c.createUrlTree(this.#n.routing?.guest).toString()}`;s.unshift(c),s.unshift(`${c}/`)}let a=s.find(c=>n.includes(c));await dn({global:o,oauth:{redirectUrl:a}}),this.authState.reload(),this.#e.navigateToGuestPage()}catch(r){return this.#o(this.#r("signOut",r))}}async signUp(o){try{this.#t.reset();let r=Object.fromEntries(Object.entries(o.attributes||{}).map(([s,a])=>[s,typeof a=="number"?a:String(a)])),n=this.#n.identifierType==="email"?o.identifier:void 0,{nextStep:i}=await Qr({username:o.identifier,password:o.password,options:{userAttributes:u({email:n,name:o.fullName},r)}});switch(i.signUpStep){case"DONE":this.#e.nextStep("login",{identifier:o.identifier});break;case"CONFIRM_SIGN_UP":this.#e.nextStep("confirm_sign_up",{identifier:o.identifier});break;case"COMPLETE_AUTO_SIGN_IN":this.#e.nextStep("login",{identifier:o.identifier});break}}catch(r){return this.#o(this.#r("signUp",r))}}async confirmSignIn(o){try{this.#t.reset();let{nextStep:r}=await nn({challengeResponse:o.code});switch(r.signInStep){case"DONE":this.#s();break;case"CONFIRM_SIGN_UP":this.#e.nextStep("confirm_sign_up",{identifier:o.identifier});break;default:throw new He("Unexpected next step: "+r)}}catch(r){return this.#o(this.#r("confirmSignIn",r))}}async confirmSignUp(o){try{this.#t.reset();let{nextStep:r}=await rn({username:o.identifier,confirmationCode:o.code});switch(r.signUpStep){case"DONE":this.#e.nextStep("login",{identifier:o.identifier});break;case"CONFIRM_SIGN_UP":this.#e.nextStep("confirm_sign_up",{identifier:o.identifier});break;case"COMPLETE_AUTO_SIGN_IN":this.#e.nextStep("login",{identifier:o.identifier});break;default:throw new He("Unexpected next step: "+r)}}catch(r){return"message"in r&&r.message==="User cannot be confirmed. Current status is CONFIRMED"&&this.#e.nextStep("login",{identifier:o.identifier}),this.#o(this.#r("signIn",r))}}async resendSignUpCode(o){try{this.#t.reset(),await on({username:o.identifier})}catch(r){return this.#o(this.#r("resendSignUpCode",r))}}async signIn(o){try{this.#t.reset();let r;switch(this.#n.passwordlessEnabled?r=await gt({username:o.identifier,options:{authFlowType:"USER_AUTH",preferredChallenge:"EMAIL_OTP"}}):r=await gt({username:o.identifier,password:o.password}),r.nextStep.signInStep){case"DONE":this.#s();break;case"CONFIRM_SIGN_UP":this.#e.nextStep("confirm_sign_up",{identifier:o.identifier});break;case"CONFIRM_SIGN_IN_WITH_EMAIL_CODE":case"CONFIRM_SIGN_IN_WITH_SMS_CODE":this.#e.nextStep("confirm_sign_in",{identifier:o.identifier});break;case"RESET_PASSWORD":this.#e.nextStep("reset_password",{identifier:o.identifier});break;default:throw new He("Unexpected next step: "+r.nextStep)}}catch(r){return this.#o(this.#r("signIn",r))}}async forgotPassword(o){try{this.#t.reset();let{nextStep:r}=await en({username:o.identifier});switch(r.resetPasswordStep){case"DONE":this.#e.nextStep("login",{identifier:o.identifier});break;case"CONFIRM_RESET_PASSWORD_WITH_CODE":this.#e.nextStep("reset_password",{identifier:o.identifier});break;default:throw new He("Unexpected next step: "+r)}}catch(r){return this.#o(this.#r("forgotPassword",r))}}async confirmForgotPassword(o){try{if(!o.code)throw new He("Code is required to confirm forgot password","Make sure to call forgotPassword first.");this.#t.reset(),await tn({username:o.identifier,confirmationCode:o.code,newPassword:o.newPassword}),this.#e.nextStep("login",{identifier:o.identifier})}catch(r){return this.#o(this.#r("confirmForgotPassword",r))}}async changePassword(){throw new se("changePassword","unknown","Method not supported. Use forgotPassword and confirmForgotPassword instead.")}async signInWithProvider(o){try{this.#t.reset();let r;switch(o){case"google":r="Google";break;case"facebook":r="Facebook";break;case"apple":r="Apple";break;case"amazon":r="Amazon";break;default:r={custom:o}}await ir({provider:r})}catch(r){return this.#o(this.#r("signInWithProvider",r))}}#r(o,r){switch(!0){case String(r).includes("Cannot reset password for the user as there is no registered/verified email"):return new se(o,"notVerified",r);case String(r).includes("already a signed in user"):return new se(o,"alreadySignedIn",r);case String(r).includes("User already exists."):return new se(o,"userAlreadyExists",r);case String(r).includes("User is not confirmed."):return new se(o,"userIsNotConfirmed",r);case String(r).includes("User does not exist."):case String(r).includes("Username/client id combination not found."):return new se(o,"userDoesNotExist",r);case String(r).includes("Incorrect username or password."):return new se(o,"incorrectIdentifierOrPassword",r);case String(r).includes("Invalid verification code provided, please try again"):return new se(o,"invalidCode",r);case String(r).includes("The given preferredRedirectUrl"):return console.error(r),new se(o,"invalidConfiguration",r,!0);case String(r).includes("User cancelled OAuth flow"):return console.error(r),new se(o,"cancelledFlow",r,!0);case String(r).includes("can not be converted to"):return new se(o,"invalidConfiguration",new He("Invalid configuration, see console for details","Make sure you set up the attributes options correctly."),!0);default:return console.error(r),new se(o,"unknown",r)}}#o(o){return this.#t.handle(o),o}#s(){this.#e.nextStep("login"),this.authState.reload(),!this.#i&&(this.#i=this.#u.subscribe(()=>{this.#e.navigateToSecuredPage(),this.#i?.unsubscribe(),this.#i=void 0}))}static \u0275fac=function(r){return new(r||e)};static \u0275prov=yn({token:e,factory:e.\u0275fac})}return e})();export{XN as a,ZN as b};
